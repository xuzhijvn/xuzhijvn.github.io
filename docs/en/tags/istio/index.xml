<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>istio on ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³</title>
    <link>https://xuzhijvn.github.io/en/tags/istio/</link>
    <description>Recent content in istio on ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>Copyright Â© 2016-{year} Razon Yang. All Rights Reserved.</copyright>
    <lastBuildDate>Fri, 27 Aug 2021 11:15:10 +0800</lastBuildDate><atom:link href="https://xuzhijvn.github.io/en/tags/istio/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>istioåŸç†</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/istio%E5%8E%9F%E7%90%86/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/istio%E5%8E%9F%E7%90%86/</guid>
      <description>istioåŸç†</description>
    </item>
    
    <item>
      <title>istioå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%90%AF%E7%94%A8%E7%AD%96%E7%95%A5%E6%A3%80%E6%9F%A5%E5%8A%9F%E8%83%BD/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%90%AF%E7%94%A8%E7%AD%96%E7%95%A5%E6%A3%80%E6%9F%A5%E5%8A%9F%E8%83%BD/</guid>
      <description>istioå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½
ä¸å¾—ä¸è¯´ï¼Œistioçš„å®˜æ–¹æ–‡æ¡£çœŸçš„å¾ˆåƒåœ¾ï¼Œæ“ä½œæ‰‹å†Œæ²¡æœ‰éšç€ç‰ˆæœ¬åŒæ­¥æ›´æ–°ä¸è¯´ï¼Œå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½ä¾ç…§å®˜æ–¹åšæ³•ä¹Ÿä¸èƒ½ç”Ÿæ•ˆã€‚ç°å…ˆä»¥istio-1.5.10ä¸ºä¾‹æ€»ç»“å¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½çš„æ–¹æ³•å¦‚ä¸‹ï¼š
 é»˜è®¤å®‰è£…istioä¹‹ådisablePolicyChecks=true  [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system get cm Istio -o jsonpath=&amp;#34;{@.data.mesh}&amp;#34; | grep disablePolicyChecks disablePolicyChecks: true ç¼–è¾‘ istio configmap ä»¥å¯ç”¨ç­–ç•¥æ£€æŸ¥  [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system get cm Istio -o jsonpath=&amp;#34;{@.data.mesh}&amp;#34; | sed -e &amp;#34;s/disablePolicyChecks: true/disablePolicyChecks: false/&amp;#34; &amp;gt; /tmp/mesh.yaml [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system create cm Istio -o yaml --dry-run --from-file=mesh=/tmp/mesh.yaml | kubectl replace -f - W0902 17:00:37.208604 16538 helpers.go:535] --dry-run is deprecated and can be replaced with --dry-run=client.</description>
    </item>
    
    <item>
      <title>istioå®‰è£…</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%89%E8%A3%85/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%89%E8%A3%85/</guid>
      <description>istioå®‰è£…
1. ä¸‹è½½ Istio è¿™é‡Œæ¨èç›´æ¥ä¸‹è½½tar.gzå®‰è£…åŒ…ï¼Œä¸æ¨èä½¿ç”¨å®˜ç½‘ä¸Šçš„é‚£ä¸ªå®‰è£…è„šæœ¬ï¼ˆæ…¢å¾—ä¸€é€¼ï¼‰ã€‚å¦å¤–æ¨èä¸‹è½½istio-1.5.10ï¼Œä¸æ¨èä¸‹è½½1.7.0ã€‚
è§£å‹ï¼š
tar -xzvf Istio-1.5.10-linux.tar.gz æ‹·è´istioctlåˆ°/usr/local/bin/
cd Istio-1.5.10/ cp bin/istioctl /usr/local/bin/ æŸ¥çœ‹ç‰ˆæœ¬ï¼š
istioctl version 2. å®‰è£…istio åŸºäºdemoçš„é…ç½®å®‰è£…istioï¼ˆé™¤äº†demoï¼Œè¿˜æœ‰defaultç­‰ç­‰ï¼Œå…·ä½“é…ç½®è§istio-1.5.10/install/kubernetes/operator/profilesï¼‰
istioctl manifest apply --set profile=demo æŸ¥çœ‹svcï¼škubectl get svc -n istio-system
æŸ¥çœ‹podï¼škubectl get pods -n istio-system
è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯1.5.10ä»¥åçš„é«˜ç‰ˆæœ¬ï¼Œå®‰è£…å‘½ä»¤åº”è¯¥æ˜¯ï¼šistioctl manifest install --set profile=demo
å¹¶ä¸”ï¼Œæœ€æ–°ç‰ˆæœ¬1.7.0ä¸å†é»˜è®¤å®‰è£…grafana ``kiali ``zipkinç­‰ç­‰ç»„ä»¶ã€‚
å½“ä½¿ç”¨ kubectl apply æ¥éƒ¨ç½²åº”ç”¨æ—¶ï¼Œå¦‚æœ pod å¯åŠ¨åœ¨æ ‡æœ‰ istio-injection=enabled çš„å‘½åç©ºé—´ä¸­ï¼Œé‚£ä¹ˆï¼ŒIstio sidecar æ³¨å…¥å™¨å°†è‡ªåŠ¨æ³¨å…¥ Envoy å®¹å™¨åˆ°åº”ç”¨çš„ pod ä¸­ï¼š
kubectl label namespace &amp;lt;namespace&amp;gt; Istio-injection=enabled 3.å¸è½½ å¸è½½ç¨‹åºå°†åˆ é™¤ RBAC æƒé™ã€istio-system å‘½åç©ºé—´å’Œæ‰€æœ‰ç›¸å…³èµ„æºã€‚å¯ä»¥å¿½ç•¥é‚£äº›ä¸å­˜åœ¨çš„èµ„æºçš„æŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å·²ç»è¢«åˆ é™¤æ‰äº†ã€‚
istioctl manifest generate --set profile=demo | kubectl delete -f - å‚è€ƒ istioå®˜ç½‘: å¼€å§‹</description>
    </item>
    
    <item>
      <title>istioå®ç°ç°åº¦</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</guid>
      <description>istioå®ç°ç°åº¦
Gateway apiVersion: networking.istio.io/v1alpha3 kind: Gateway metadata:  name: bookinfo-gateway spec:  selector:  istio: ingressgateway # use istio default controller  servers:  - port:  number: 80  name: http  protocol: HTTP  hosts:  - &amp;#34;*&amp;#34; VirtualService æ˜¯åœ¨ Istio æœåŠ¡ç½‘æ ¼å†…å¯¹æœåŠ¡çš„è¯·æ±‚å¦‚ä½•è¿›è¡Œè·¯ç”±æ§åˆ¶ï¼ŸVirtualService ä¸­å°±åŒ…å«äº†è¿™æ–¹é¢çš„å®šä¹‰ã€‚ä¾‹å¦‚ä¸€ä¸ª Virtual Service å¯ä»¥æŠŠè¯·æ±‚è·¯ç”±åˆ°ä¸åŒç‰ˆæœ¬ï¼Œç”šè‡³æ˜¯å¯ä»¥è·¯ç”±åˆ°ä¸€ä¸ªå®Œå…¨ä¸åŒäºè¯·æ±‚è¦æ±‚çš„æœåŠ¡ä¸Šå»ã€‚è·¯ç”±å¯ä»¥ç”¨å¾ˆå¤šæ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œä¾‹å¦‚è¯·æ±‚çš„æºå’Œç›®çš„åœ°ã€HTTP è·¯å¾„å’Œ Header ä»¥åŠå„ä¸ªæœåŠ¡ç‰ˆæœ¬çš„æƒé‡ç­‰ã€‚
è·¯ç”±è§„åˆ™å¯¹åº”ç€ä¸€æˆ–å¤šä¸ªç”¨ VirtualService é…ç½®æŒ‡å®šçš„è¯·æ±‚ç›®çš„ä¸»æœºã€‚è¿™äº›ä¸»æœºå¯ä»¥æ˜¯ä¹Ÿå¯ä»¥ä¸æ˜¯å®é™…çš„ç›®æ ‡è´Ÿè½½ï¼Œç”šè‡³å¯ä»¥ä¸æ˜¯åŒä¸€ç½‘æ ¼å†…å¯è·¯ç”±çš„æœåŠ¡ã€‚ä¾‹å¦‚è¦ç»™åˆ° reviews æœåŠ¡çš„è¯·æ±‚å®šä¹‰è·¯ç”±è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨å†…éƒ¨çš„åç§° reviewsï¼Œä¹Ÿå¯ä»¥ç”¨åŸŸå bookinfo.comï¼ŒVirtualService å¯ä»¥å®šä¹‰è¿™æ ·çš„ host å­—æ®µï¼š
hosts: - reviews - bookinfo.comå¤åˆ¶ä»£ç  host å­—æ®µç”¨æ˜¾ç¤ºæˆ–è€…éšå¼çš„æ–¹å¼å®šä¹‰äº†ä¸€æˆ–å¤šä¸ªå®Œå…¨é™å®šåï¼ˆFQDNï¼‰ã€‚ä¸Šé¢çš„ reviewsï¼Œä¼šéšå¼çš„æ‰©å±•æˆä¸ºç‰¹å®šçš„ FQDNï¼Œä¾‹å¦‚åœ¨ Kubernetes ç¯å¢ƒä¸­ï¼Œå…¨åä¼šä» VirtualService æ‰€åœ¨çš„é›†ç¾¤å’Œå‘½åç©ºé—´ä¸­ç»§æ‰¿è€Œæ¥ï¼ˆæ¯”å¦‚è¯´ reviews.</description>
    </item>
    
    <item>
      <title>æš´éœ²grafanaç­‰å†…éƒ¨ç»„ä»¶æœåŠ¡</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/%E6%9A%B4%E9%9C%B2grafana%E7%AD%89%E5%86%85%E9%83%A8%E7%BB%84%E4%BB%B6%E6%9C%8D%E5%8A%A1/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/%E6%9A%B4%E9%9C%B2grafana%E7%AD%89%E5%86%85%E9%83%A8%E7%BB%84%E4%BB%B6%E6%9C%8D%E5%8A%A1/</guid>
      <description>æš´éœ²grafanaç­‰å†…éƒ¨ç»„ä»¶æœåŠ¡
åœ¨å®‰è£…å®Œæˆistioåï¼Œé»˜è®¤çŠ¶æ€ä¸‹ï¼Œé›†ç¾¤å¤–ç”¨æˆ·ä¸èƒ½ç›´æ¥è®¿é—®istioé›†ç¾¤å†…çš„grafanaç­‰ç®¡ç†ã€ç›‘æ§æœåŠ¡ã€‚
æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å°†é›†ç¾¤å†…æœåŠ¡å¼€æ”¾å‡ºæ¥ã€‚ä¸€ç§æ˜¯ä½¿ç”¨port-forwardæ–¹å¼å°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°podç«¯å£ï¼Œå®ç°é›†ç¾¤å†…æœåŠ¡çš„è®¿é—®ï¼›å¦ä¸€ç§æ–¹å¼æ˜¯é‡‡ç”¨istio gatewayæ–¹å¼ï¼Œå°†é›†ç¾¤å†…æœåŠ¡æš´éœ²åˆ°å¤–ç½‘ã€‚
ç¬¬ä¸€ç§æ–¹å¼ï¼ˆä»¥æš´éœ²Prometheusä¸ºä¾‹ï¼Œå®˜æ–¹æ•™ç¨‹ä¹Ÿæ˜¯è¿™ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æå…¶åäººç±»ï¼Œæ¨èä½¿ç”¨ä¸‹é¢çš„ç¬¬äºŒç§æ–¹å¼ï¼‰ï¼š
kubectl -n Istio-system port-forward $(kubectl -n Istio-system get pod -l app=prometheus -o jsonpath=&amp;#39;{.items[0].metadata.name}&amp;#39;) 9090:9090 &amp;amp; ç¬¬äºŒç§æ–¹å¼éœ€è¦å°†é›†ç¾¤çš„é»˜è®¤ç½‘å…³æœåŠ¡ingressgatewayçš„ç½‘ç»œæ¨¡å¼è®¾ç½®ä¸ºLB/nodeportæ¨¡å¼ï¼Œä½œä¸ºä»£ç†å®ç°å¯¹å¤–æœåŠ¡ã€‚
1. è®¾ç½®ingress gatewayçš„å·¥ä½œæ¨¡å¼ å®‰è£…istioçš„æ—¶å€™é»˜è®¤å°±æ˜¯LBçš„
2. éªŒè¯ingress gatewayçš„ç½‘ç»œæ¨¡å¼ [root@k8s-master ~]# kubectl get svc -n Istio-system NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE grafana ClusterIP 10.101.122.19 &amp;lt;none&amp;gt; 3000/TCP 11h Istio-egressgateway ClusterIP 10.106.2.83 &amp;lt;none&amp;gt; 80/TCP,443/TCP,15443/TCP 11h Istio-ingressgateway LoadBalancer 10.110.238.41 &amp;lt;pending&amp;gt; 15020:31598/TCP,80:30299/TCP,443:31413/TCP,15029:30249/TCP,15030:32499/TCP,15031:31399/TCP,15032:32373/TCP,31400:30156/TCP,15443:30319/TCP 11h Istio-pilot ClusterIP 10.103.43.172 &amp;lt;none&amp;gt; 15010/TCP,15011/TCP,15012/TCP,8080/TCP,15014/TCP,443/TCP 11h istiod ClusterIP 10.105.251.21 &amp;lt;none&amp;gt; 15012/TCP,443/TCP 11h jaeger-agent ClusterIP None &amp;lt;none&amp;gt; 5775/UDP,6831/UDP,6832/UDP 11h jaeger-collector ClusterIP 10.</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼åŸç†</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E5%8E%9F%E7%90%86/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E5%8E%9F%E7%90%86/</guid>
      <description>æœåŠ¡ç½‘æ ¼åŸç†</description>
    </item>
    
  </channel>
</rss>
