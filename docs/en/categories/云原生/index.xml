<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>äº‘åŸç”Ÿ on ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³</title>
    <link>https://xuzhijvn.github.io/en/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/</link>
    <description>Recent content in äº‘åŸç”Ÿ on ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡³</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>Copyright Â© 2016-{year} Razon Yang. All Rights Reserved.</copyright>
    <lastBuildDate>Sun, 15 May 2022 14:46:38 +0800</lastBuildDate><atom:link href="https://xuzhijvn.github.io/en/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Yshop K8s</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/yshop-k8s/</link>
      <pubDate>Sun, 15 May 2022 14:46:38 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/yshop-k8s/</guid>
      <description></description>
    </item>
    
    <item>
      <title>ingress</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/ingress/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/ingress/</guid>
      <description>1. ingressæ˜¯ä»€ä¹ˆ ingressæ˜¯k8sä¸€ç§èµ„æºå¯¹è±¡ï¼Œå¦‚k8sçš„Deploymentã€Serviceèµ„æºå¯¹è±¡ä¸€æ ·ã€‚å®ƒæ˜¯ä¸€ç§é›†ç¾¤ç»´åº¦æš´éœ²æœåŠ¡çš„æ–¹å¼ï¼Œæ­£å¦‚k8sçš„ClusterIPã€NodePortã€LoadBalanceä¸€æ ·ï¼Œä½†æ˜¯ClusterIPçš„æ–¹å¼åªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è®¿é—®ï¼ŒNodePortæ–¹å¼çš„è¯ï¼Œæµ‹è¯•ç¯å¢ƒä½¿ç”¨è¿˜è¡Œï¼Œå½“æœ‰å‡ åä¸Šç™¾çš„æœåŠ¡åœ¨é›†ç¾¤ä¸­è¿è¡Œæ—¶ï¼ŒNodePortçš„ç«¯å£ç®¡ç†æ˜¯ç¾éš¾ï¼ŒLoadBalanceæ–¹å¼å—é™äºäº‘å¹³å°ï¼Œä¸”é€šå¸¸åœ¨äº‘å¹³å°éƒ¨ç½²ELBè¿˜éœ€è¦é¢å¤–çš„è´¹ç”¨ã€‚ingressè§„åˆ™æ˜¯å¾ˆçµæ´»çš„ï¼Œå¯ä»¥æ ¹æ®ä¸åŒåŸŸåã€ä¸åŒpathè½¬å‘è¯·æ±‚åˆ°ä¸åŒçš„serviceï¼Œå¹¶ä¸”æ”¯æŒhttps/httpã€‚
2. ingressä¸ingress-controller è¦ç†è§£ingressï¼Œéœ€è¦åŒºåˆ†ä¸¤ä¸ªæ¦‚å¿µï¼Œingresså’Œingress-controllerï¼š
 ingressï¼šæŒ‡çš„æ˜¯k8sä¸­çš„ä¸€ä¸ªapiå¯¹è±¡ï¼Œä¸€èˆ¬ç”¨yamlé…ç½®ã€‚ä½œç”¨æ˜¯å®šä¹‰è¯·æ±‚å¦‚ä½•è½¬å‘åˆ°serviceçš„è§„åˆ™ï¼Œå¯ä»¥ç†è§£ä¸ºé…ç½®æ¨¡æ¿ã€‚ ingress-controllerï¼šå…·ä½“å®ç°åå‘ä»£ç†åŠè´Ÿè½½å‡è¡¡çš„ç¨‹åºï¼Œå¯¹ingresså®šä¹‰çš„è§„åˆ™è¿›è¡Œè§£æï¼Œæ ¹æ®é…ç½®çš„è§„åˆ™æ¥å®ç°è¯·æ±‚è½¬å‘ã€‚  ç®€å•æ¥è¯´ï¼Œingress-controlleræ‰æ˜¯è´Ÿè´£å…·ä½“è½¬å‘çš„ç»„ä»¶ï¼Œé€šè¿‡å„ç§æ–¹å¼å°†å®ƒæš´éœ²åœ¨é›†ç¾¤å…¥å£ï¼Œå¤–éƒ¨å¯¹é›†ç¾¤çš„è¯·æ±‚æµé‡ä¼šå…ˆåˆ°ingress-controllerï¼Œè€Œingresså¯¹è±¡æ˜¯ç”¨æ¥å‘Šè¯‰ingress-controllerè¯¥å¦‚ä½•è½¬å‘è¯·æ±‚ï¼Œæ¯”å¦‚å“ªäº›åŸŸåå“ªäº›pathè¦è½¬å‘åˆ°å“ªäº›æœåŠ¡ç­‰ç­‰ã€‚
2.1 ingress ingressæ˜¯ä¸€ä¸ªAPIå¯¹è±¡ï¼Œå’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œé€šè¿‡yamlæ–‡ä»¶æ¥é…ç½®ã€‚ingressé€šè¿‡httpæˆ–httpsæš´éœ²é›†ç¾¤å†…éƒ¨serviceï¼Œç»™serviceæä¾›å¤–éƒ¨URLã€è´Ÿè½½å‡è¡¡ã€SSL/TLSèƒ½åŠ›ä»¥åŠåŸºäºhostçš„æ–¹å‘ä»£ç†ã€‚ingressè¦ä¾é ingress-controlleræ¥å…·ä½“å®ç°ä»¥ä¸ŠåŠŸèƒ½ã€‚å‰ä¸€å°èŠ‚çš„å›¾å¦‚æœç”¨ingressæ¥è¡¨ç¤ºï¼Œå¤§æ¦‚å°±æ˜¯å¦‚ä¸‹é…ç½®ï¼š
apiVersion: extensions/v1beta1 kind: Ingress metadata:  name: abc-ingress  annotations:  kubernetes.io/ingress.class: &amp;#34;nginx&amp;#34;  nginx.ingress.kubernetes.io/use-regex: &amp;#34;true&amp;#34; spec:  tls:  - hosts:  - api.abc.com  secretName: abc-tls  rules:  - host: api.abc.com  http:  paths:  - backend:  serviceName: apiserver  servicePort: 80  - host: www.abc.com  http:  paths:  - path: /image/*  backend:  serviceName: fileserver  servicePort: 80  - host: www.</description>
    </item>
    
    <item>
      <title>ingresså®ç°ç°åº¦</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/ingress%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/ingress%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</guid>
      <description>Nginx-ingress æ¶æ„å’ŒåŸç† è¿…é€Ÿå›é¡¾ä¸€ä¸‹ Nginx-ingress çš„æ¶æ„å’Œå®ç°åŸç†ï¼š
Nginx-ingress é€šè¿‡å‰ç½®çš„ Loadbalancer ç±»å‹çš„ Service æ¥æ”¶é›†ç¾¤æµé‡ï¼Œå°†æµé‡è½¬å‘è‡³ Nginx-ingress Pod å†…å¹¶å¯¹é…ç½®çš„ç­–ç•¥è¿›è¡Œæ£€æŸ¥ï¼Œå†è½¬å‘è‡³ç›®æ ‡ Serviceï¼Œæœ€ç»ˆå°†æµé‡è½¬å‘è‡³ä¸šåŠ¡å®¹å™¨ã€‚
ä¼ ç»Ÿçš„ Nginx éœ€è¦æˆ‘ä»¬é…ç½® conf æ–‡ä»¶ç­–ç•¥ã€‚ä½† Nginx-ingress é€šè¿‡å®ç° Nginx-ingress-Controller å°†åŸç”Ÿ conf é…ç½®æ–‡ä»¶å’Œ yaml é…ç½®æ–‡ä»¶è¿›è¡Œäº†è½¬åŒ–ï¼Œå½“æˆ‘ä»¬é…ç½® yaml æ–‡ä»¶çš„ç­–ç•¥åï¼ŒNginx-ingress-Controller å°†å¯¹å…¶è¿›è¡Œè½¬åŒ–ï¼Œå¹¶ä¸”åŠ¨æ€æ›´æ–°ç­–ç•¥ï¼ŒåŠ¨æ€ Reload Nginx Podï¼Œå®ç°è‡ªåŠ¨ç®¡ç†ã€‚
é‚£ä¹ˆ Nginx-ingress-Controller å¦‚ä½•èƒ½å¤ŸåŠ¨æ€æ„ŸçŸ¥é›†ç¾¤çš„ç­–ç•¥å˜åŒ–å‘¢ï¼Ÿæ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥é€šè¿‡ webhook admission æ‹¦æˆªå™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ ServiceAccount ä¸ Kubernetes Api è¿›è¡Œäº¤äº’ï¼ŒåŠ¨æ€è·å–ã€‚Nginx-ingress-Controller ä½¿ç”¨åè€…æ¥å®ç°ã€‚æ‰€ä»¥åœ¨éƒ¨ç½² Nginx-ingress æˆ‘ä»¬ä¼šå‘ç° Deployment å†…æŒ‡å®šäº† Pod çš„ ServiceAccountï¼Œä»¥åŠå®ç°äº† RoleBinding ï¼Œæœ€ç»ˆè¾¾åˆ° Pod ä¸ Kubernetes Api äº¤äº’çš„ç›®æ ‡ã€‚
dev apiVersion: v1 kind: Namespace metadata:  name: dev --- apiVersion: apps/v1 kind: Deployment metadata:  name: nginx  namespace: dev spec:  selector:  matchLabels:  app: nginx  replicas: 1  template:  metadata:  labels:  app: nginx  spec:  containers:  - name: nginx  image: wangweicoding-docker.</description>
    </item>
    
    <item>
      <title>istioåŸç†</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/istio%E5%8E%9F%E7%90%86/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/istio%E5%8E%9F%E7%90%86/</guid>
      <description>istioåŸç†</description>
    </item>
    
    <item>
      <title>istioå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%90%AF%E7%94%A8%E7%AD%96%E7%95%A5%E6%A3%80%E6%9F%A5%E5%8A%9F%E8%83%BD/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%90%AF%E7%94%A8%E7%AD%96%E7%95%A5%E6%A3%80%E6%9F%A5%E5%8A%9F%E8%83%BD/</guid>
      <description>istioå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½
ä¸å¾—ä¸è¯´ï¼Œistioçš„å®˜æ–¹æ–‡æ¡£çœŸçš„å¾ˆåƒåœ¾ï¼Œæ“ä½œæ‰‹å†Œæ²¡æœ‰éšç€ç‰ˆæœ¬åŒæ­¥æ›´æ–°ä¸è¯´ï¼Œå¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½ä¾ç…§å®˜æ–¹åšæ³•ä¹Ÿä¸èƒ½ç”Ÿæ•ˆã€‚ç°å…ˆä»¥istio-1.5.10ä¸ºä¾‹æ€»ç»“å¯ç”¨ç­–ç•¥æ£€æŸ¥åŠŸèƒ½çš„æ–¹æ³•å¦‚ä¸‹ï¼š
 é»˜è®¤å®‰è£…istioä¹‹ådisablePolicyChecks=true  [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system get cm Istio -o jsonpath=&amp;#34;{@.data.mesh}&amp;#34; | grep disablePolicyChecks disablePolicyChecks: true ç¼–è¾‘ istio configmap ä»¥å¯ç”¨ç­–ç•¥æ£€æŸ¥  [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system get cm Istio -o jsonpath=&amp;#34;{@.data.mesh}&amp;#34; | sed -e &amp;#34;s/disablePolicyChecks: true/disablePolicyChecks: false/&amp;#34; &amp;gt; /tmp/mesh.yaml [root@k8s-master Istio-1.5.10]# kubectl -n Istio-system create cm Istio -o yaml --dry-run --from-file=mesh=/tmp/mesh.yaml | kubectl replace -f - W0902 17:00:37.208604 16538 helpers.go:535] --dry-run is deprecated and can be replaced with --dry-run=client.</description>
    </item>
    
    <item>
      <title>istioå®‰è£…</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%89%E8%A3%85/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%89%E8%A3%85/</guid>
      <description>istioå®‰è£…
1. ä¸‹è½½ Istio è¿™é‡Œæ¨èç›´æ¥ä¸‹è½½tar.gzå®‰è£…åŒ…ï¼Œä¸æ¨èä½¿ç”¨å®˜ç½‘ä¸Šçš„é‚£ä¸ªå®‰è£…è„šæœ¬ï¼ˆæ…¢å¾—ä¸€é€¼ï¼‰ã€‚å¦å¤–æ¨èä¸‹è½½istio-1.5.10ï¼Œä¸æ¨èä¸‹è½½1.7.0ã€‚
è§£å‹ï¼š
tar -xzvf Istio-1.5.10-linux.tar.gz æ‹·è´istioctlåˆ°/usr/local/bin/
cd Istio-1.5.10/ cp bin/istioctl /usr/local/bin/ æŸ¥çœ‹ç‰ˆæœ¬ï¼š
istioctl version 2. å®‰è£…istio åŸºäºdemoçš„é…ç½®å®‰è£…istioï¼ˆé™¤äº†demoï¼Œè¿˜æœ‰defaultç­‰ç­‰ï¼Œå…·ä½“é…ç½®è§istio-1.5.10/install/kubernetes/operator/profilesï¼‰
istioctl manifest apply --set profile=demo æŸ¥çœ‹svcï¼škubectl get svc -n istio-system
æŸ¥çœ‹podï¼škubectl get pods -n istio-system
è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯1.5.10ä»¥åçš„é«˜ç‰ˆæœ¬ï¼Œå®‰è£…å‘½ä»¤åº”è¯¥æ˜¯ï¼šistioctl manifest install --set profile=demo
å¹¶ä¸”ï¼Œæœ€æ–°ç‰ˆæœ¬1.7.0ä¸å†é»˜è®¤å®‰è£…grafana ``kiali ``zipkinç­‰ç­‰ç»„ä»¶ã€‚
å½“ä½¿ç”¨ kubectl apply æ¥éƒ¨ç½²åº”ç”¨æ—¶ï¼Œå¦‚æœ pod å¯åŠ¨åœ¨æ ‡æœ‰ istio-injection=enabled çš„å‘½åç©ºé—´ä¸­ï¼Œé‚£ä¹ˆï¼ŒIstio sidecar æ³¨å…¥å™¨å°†è‡ªåŠ¨æ³¨å…¥ Envoy å®¹å™¨åˆ°åº”ç”¨çš„ pod ä¸­ï¼š
kubectl label namespace &amp;lt;namespace&amp;gt; Istio-injection=enabled 3.å¸è½½ å¸è½½ç¨‹åºå°†åˆ é™¤ RBAC æƒé™ã€istio-system å‘½åç©ºé—´å’Œæ‰€æœ‰ç›¸å…³èµ„æºã€‚å¯ä»¥å¿½ç•¥é‚£äº›ä¸å­˜åœ¨çš„èµ„æºçš„æŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å·²ç»è¢«åˆ é™¤æ‰äº†ã€‚
istioctl manifest generate --set profile=demo | kubectl delete -f - å‚è€ƒ istioå®˜ç½‘: å¼€å§‹</description>
    </item>
    
    <item>
      <title>istioå®ç°ç°åº¦</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/istio%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</guid>
      <description>istioå®ç°ç°åº¦
Gateway apiVersion: networking.istio.io/v1alpha3 kind: Gateway metadata:  name: bookinfo-gateway spec:  selector:  istio: ingressgateway # use istio default controller  servers:  - port:  number: 80  name: http  protocol: HTTP  hosts:  - &amp;#34;*&amp;#34; VirtualService æ˜¯åœ¨ Istio æœåŠ¡ç½‘æ ¼å†…å¯¹æœåŠ¡çš„è¯·æ±‚å¦‚ä½•è¿›è¡Œè·¯ç”±æ§åˆ¶ï¼ŸVirtualService ä¸­å°±åŒ…å«äº†è¿™æ–¹é¢çš„å®šä¹‰ã€‚ä¾‹å¦‚ä¸€ä¸ª Virtual Service å¯ä»¥æŠŠè¯·æ±‚è·¯ç”±åˆ°ä¸åŒç‰ˆæœ¬ï¼Œç”šè‡³æ˜¯å¯ä»¥è·¯ç”±åˆ°ä¸€ä¸ªå®Œå…¨ä¸åŒäºè¯·æ±‚è¦æ±‚çš„æœåŠ¡ä¸Šå»ã€‚è·¯ç”±å¯ä»¥ç”¨å¾ˆå¤šæ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œä¾‹å¦‚è¯·æ±‚çš„æºå’Œç›®çš„åœ°ã€HTTP è·¯å¾„å’Œ Header ä»¥åŠå„ä¸ªæœåŠ¡ç‰ˆæœ¬çš„æƒé‡ç­‰ã€‚
è·¯ç”±è§„åˆ™å¯¹åº”ç€ä¸€æˆ–å¤šä¸ªç”¨ VirtualService é…ç½®æŒ‡å®šçš„è¯·æ±‚ç›®çš„ä¸»æœºã€‚è¿™äº›ä¸»æœºå¯ä»¥æ˜¯ä¹Ÿå¯ä»¥ä¸æ˜¯å®é™…çš„ç›®æ ‡è´Ÿè½½ï¼Œç”šè‡³å¯ä»¥ä¸æ˜¯åŒä¸€ç½‘æ ¼å†…å¯è·¯ç”±çš„æœåŠ¡ã€‚ä¾‹å¦‚è¦ç»™åˆ° reviews æœåŠ¡çš„è¯·æ±‚å®šä¹‰è·¯ç”±è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨å†…éƒ¨çš„åç§° reviewsï¼Œä¹Ÿå¯ä»¥ç”¨åŸŸå bookinfo.comï¼ŒVirtualService å¯ä»¥å®šä¹‰è¿™æ ·çš„ host å­—æ®µï¼š
hosts: - reviews - bookinfo.comå¤åˆ¶ä»£ç  host å­—æ®µç”¨æ˜¾ç¤ºæˆ–è€…éšå¼çš„æ–¹å¼å®šä¹‰äº†ä¸€æˆ–å¤šä¸ªå®Œå…¨é™å®šåï¼ˆFQDNï¼‰ã€‚ä¸Šé¢çš„ reviewsï¼Œä¼šéšå¼çš„æ‰©å±•æˆä¸ºç‰¹å®šçš„ FQDNï¼Œä¾‹å¦‚åœ¨ Kubernetes ç¯å¢ƒä¸­ï¼Œå…¨åä¼šä» VirtualService æ‰€åœ¨çš„é›†ç¾¤å’Œå‘½åç©ºé—´ä¸­ç»§æ‰¿è€Œæ¥ï¼ˆæ¯”å¦‚è¯´ reviews.</description>
    </item>
    
    <item>
      <title>Javaåº”ç”¨ä»nfsåŠ è½½é…ç½®æ–‡ä»¶</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/java%E5%BA%94%E7%94%A8%E4%BB%8Enfs%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/java%E5%BA%94%E7%94%A8%E4%BB%8Enfs%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</guid>
      <description>Javaåº”ç”¨ä»nfsåŠ è½½é…ç½®æ–‡ä»¶
èƒŒæ™¯ é…ç½®æ–‡ä»¶å˜åŒ–ï¼Œæ— éœ€é‡æ–°æ„å»ºé•œåƒéƒ¨ç½²ã€‚
1. å‡†å¤‡nfs 1ã€å‡†å¤‡å¥½nfsæœåŠ¡å™¨ã€‚å‚è€ƒï¼šnfså®‰è£… çš„nfsæœåŠ¡ç«¯é…ç½®ã€‚ 2ã€k8s nodeèŠ‚ç‚¹å¯ä»¥ä¸å¯ç”¨rpcbindæœåŠ¡ï¼Œä½†æ˜¯å¿…é¡»å®‰è£…nfs-utilsï¼ˆyum install nfs-utilsï¼‰ï¼Œå¦åˆ™nfs-client-provisioner podæ— æ³•å¯åŠ¨ï¼Œå› ä¸ºnfs-client.yamlé‡Œé¢æœ‰nfsçš„ç›¸å…³é…ç½®ï¼Œè€Œè¿™äº›nfsé…ç½®è¦ç”Ÿæ•ˆéœ€ä¾èµ–nfs-utilsã€‚å‚è€ƒï¼šnfså®‰è£… çš„nfså®¢æˆ·ç«¯é…ç½®ã€‚
2. åˆ›å»ºStorageClasså¯¹è±¡ ç†è®ºéƒ¨åˆ†å‚è€ƒï¼šStorageClass
2.1 nfs-client.yaml kind: Deployment apiVersion: apps/v1 metadata:  name: nfs-client-provisioner spec:  replicas: 1  strategy:  type: Recreate  selector:  matchLabels:  app: nfs-client-provisioner  template:  metadata:  labels:  app: nfs-client-provisioner  spec:  serviceAccountName: nfs-client-provisioner  containers:  - name: nfs-client-provisioner  image: quay.io/external_storage/nfs-client-provisioner:latest  volumeMounts:  - name: nfs-client-root  mountPath: /persistentvolumes  env:  - name: PROVISIONER_NAME  value: fuseim.</description>
    </item>
    
    <item>
      <title>k8såŠŸèƒ½</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%8A%9F%E8%83%BD/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%8A%9F%E8%83%BD/</guid>
      <description>Kubernetesæä¾›äº†ä¸€ä¸ªå¯å¼¹æ€§è¿è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¡†æ¶ã€‚Kubernetes ä¼šæ»¡è¶³æ‚¨çš„æ‰©å±•è¦æ±‚ã€æ•…éšœè½¬ç§»ã€éƒ¨ç½²æ¨¡å¼ç­‰ã€‚å…·ä½“å¦‚ä¸‹ï¼š
 Service discovery and load balancingï¼ŒæœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡DNSå®ç°å†…éƒ¨è§£æï¼Œserviceå®ç°è´Ÿè½½å‡è¡¡ Storage orchestrationï¼Œå­˜å‚¨ç¼–æ’ï¼Œé€šè¿‡plunginçš„å½¢å¼æ”¯æŒå¤šç§å­˜å‚¨ï¼Œå¦‚æœ¬åœ°ï¼Œnfsï¼Œcephï¼Œå…¬æœ‰äº‘å¿«å­˜å‚¨ç­‰ Automated rollouts and rollbacksï¼Œè‡ªåŠ¨å‘å¸ƒä¸å›æ»šï¼Œé€šè¿‡åŒ¹é…å½“å‰çŠ¶æ€ä¸ç›®æ ‡çŠ¶æ€ä¸€è‡´ï¼Œæ›´æ–°å¤±è´¥æ—¶å¯å›æ»š Automatic bin packingï¼Œè‡ªåŠ¨èµ„æºè°ƒåº¦ï¼Œå¯ä»¥è®¾ç½®podè°ƒåº¦çš„æ‰€éœ€ï¼ˆrequestsï¼‰èµ„æºå’Œé™åˆ¶èµ„æºï¼ˆlimitsï¼‰ Self-healingï¼Œå†…ç½®çš„å¥åº·æ£€æŸ¥ç­–ç•¥ï¼Œè‡ªåŠ¨å‘ç°å’Œå¤„ç†é›†ç¾¤å†…çš„å¼‚å¸¸ï¼Œæ›´æ¢ï¼Œéœ€é‡å¯çš„podèŠ‚ç‚¹ Secret and configuration managementï¼Œå¯†é’¥å’Œé…ç½®ç®¡ç†ï¼Œå¯¹äºæ•æ„Ÿä¿¡æ¯å¦‚å¯†ç ï¼Œè´¦å·çš„é‚£ä¸ªé€šè¿‡secretå­˜å‚¨ï¼Œåº”ç”¨çš„é…ç½®æ–‡ä»¶é€šè¿‡configmapå­˜å‚¨ï¼Œé¿å…å°†é…ç½®æ–‡ä»¶å›ºå®šåœ¨é•œåƒä¸­ï¼Œå¢åŠ å®¹å™¨ç¼–æ’çš„çµæ´»æ€§ Batch executionï¼Œæ‰¹å¤„ç†æ‰§è¡Œï¼Œé€šè¿‡jobå’Œcronjobæä¾›å•æ¬¡æ‰¹å¤„ç†ä»»åŠ¡å’Œå¾ªç¯è®¡åˆ’ä»»åŠ¡åŠŸèƒ½çš„å®ç° Horizontal scalingï¼Œæ¨ªå‘æ‰©å±•åŠŸèƒ½ï¼ŒåŒ…å«æœ‰HPAå’ŒASï¼Œå³åº”ç”¨çš„åŸºäºCPUåˆ©ç”¨ç‡çš„å¼¹æ€§ä¼¸ç¼©å’ŒåŸºäºå¹³å°çº§çš„å¼¹æ€§ä¼¸ç¼©ï¼Œå¦‚è‡ªåŠ¨å¢åŠ nodeå’Œåˆ é™¤nodesèŠ‚ç‚¹ã€‚   ä½¿ç”¨kubectl autoscaleå‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª HPA å¯¹è±¡ï¼š
$ kubectl autoscale deployment wordpress --namespace kube-example --cpu-percent=20 --min=3 --max=6 horizontalpodautoscaler.autoscaling/hpa-demo autoscaled $ kubectl get hpa -n kube-example NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE wordpress Deployment/wordpress &amp;lt;unknown&amp;gt;/20% 3 6 0 13s æ­¤å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªå…³è”èµ„æº wordpress çš„ HPAï¼Œæœ€å°çš„ Pod å‰¯æœ¬æ•°ä¸º3ï¼Œæœ€å¤§ä¸º6ã€‚HPA ä¼šæ ¹æ®è®¾å®šçš„ cpu ä½¿ç”¨ç‡ï¼ˆ20%ï¼‰åŠ¨æ€çš„å¢åŠ æˆ–è€…å‡å°‘ Pod æ•°é‡ã€‚</description>
    </item>
    
    <item>
      <title>k8såŸºæœ¬æ¦‚å¿µ</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80%E6%89%AB%E7%9B%B2/k8s%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80%E6%89%AB%E7%9B%B2/k8s%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/</guid>
      <description>1âƒ£ï¸ Container Containerï¼ˆå®¹å™¨ï¼‰æ˜¯ä¸€ç§ä¾¿æºå¼ã€è½»é‡çº§çš„æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚å®ƒä½¿ç”¨ namespace éš”ç¦»ä¸åŒçš„è½¯ä»¶è¿è¡Œç¯å¢ƒï¼Œå¹¶é€šè¿‡é•œåƒè‡ªåŒ…å«è½¯ä»¶çš„è¿è¡Œç¯å¢ƒï¼Œä»è€Œä½¿å¾—å®¹å™¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œã€‚
2âƒ£ï¸ Pod Kubernetes ä½¿ç”¨ Pod æ¥ç®¡ç†å®¹å™¨ï¼Œæ¯ä¸ª Pod å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªç´§å¯†å…³è”çš„å®¹å™¨ã€‚
Pod æ˜¯ä¸€ç»„ç´§å¯†å…³è”çš„å®¹å™¨é›†åˆï¼Œå®ƒä»¬å…±äº« PIDï¼ˆåŒä¸€ä¸ªPodä¸­åº”ç”¨å¯ä»¥çœ‹åˆ°å…¶å®ƒè¿›ç¨‹ï¼‰ã€IPCï¼ˆåŒä¸€ä¸ªPodä¸­çš„åº”ç”¨å¯ä»¥é€šè¿‡VPCæˆ–è€…POSIXè¿›è¡Œé€šä¿¡ï¼‰ã€Network ï¼ˆåŒä¸€ä¸ªPodçš„ä¸­çš„åº”ç”¨å¯¹ç›¸åŒçš„IPåœ°å€å’Œç«¯å£æœ‰æƒé™ï¼‰å’Œ UTS namespaceï¼ˆåŒä¸€ä¸ªPodä¸­çš„åº”ç”¨å…±äº«ä¸€ä¸ªä¸»æœºåç§°ï¼‰ï¼Œæ˜¯ Kubernetes è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚Pod å†…çš„å¤šä¸ªå®¹å™¨å…±äº«ç½‘ç»œå’Œæ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡è¿›ç¨‹é—´é€šä¿¡å’Œæ–‡ä»¶å…±äº«è¿™ç§ç®€å•é«˜æ•ˆçš„æ–¹å¼ç»„åˆå®ŒæˆæœåŠ¡ã€‚
åœ¨ Kubernetes ä¸­ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½ä½¿ç”¨ manifestï¼ˆyaml æˆ– jsonï¼‰æ¥å®šä¹‰ï¼Œæ¯”å¦‚ä¸€ä¸ªç®€å•çš„ nginx æœåŠ¡å¯ä»¥å®šä¹‰ä¸º nginx.yamlï¼Œå®ƒåŒ…å«ä¸€ä¸ªé•œåƒä¸º nginx çš„å®¹å™¨ï¼š
apiVersion: v1 kind: Pod metadata:  name: nginx  labels:  app: nginx spec:  containers:  - name: nginx  image: nginx  ports:  - containerPort: 80 3âƒ£ï¸ Node Node æ˜¯ Pod çœŸæ­£è¿è¡Œçš„ä¸»æœºï¼Œå¯ä»¥æ˜¯ç‰©ç†æœºï¼Œä¹Ÿå¯ä»¥æ˜¯è™šæ‹Ÿæœºã€‚ä¸ºäº†ç®¡ç† Podï¼Œæ¯ä¸ª Node èŠ‚ç‚¹ä¸Šè‡³å°‘è¦è¿è¡Œ container runtimeï¼ˆæ¯”å¦‚ docker æˆ–è€… rktï¼‰ã€kubelet å’Œ kube-proxy æœåŠ¡ã€‚</description>
    </item>
    
    <item>
      <title>k8sæ¥å£</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E6%8E%A5%E5%8F%A3/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E6%8E%A5%E5%8F%A3/</guid>
      <description>å‡ ç§æ¥å£è§£é‡Šï¼š
  CRIï¼ˆContainer Runtime Interfaceï¼‰ã€‚å®¹å™¨è¿è¡Œæ—¶æ¥å£ã€‚Kubernetesé¡¹ç›®å¹¶ä¸å…³å¿ƒä½ éƒ¨ç½²çš„æ˜¯ä»€ä¹ˆå®¹å™¨è¿è¡Œæ—¶ã€ä½¿ç”¨çš„ä»€ä¹ˆæŠ€æœ¯å®ç°ï¼Œåªè¦ä½ çš„è¿™ä¸ªå®¹å™¨è¿è¡Œæ—¶èƒ½å¤Ÿè¿è¡Œæ ‡å‡†çš„å®¹å™¨é•œåƒï¼Œå®ƒå°±å¯ä»¥é€šè¿‡å®ç°CRIæ¥å…¥åˆ°Kubernetesé¡¹ç›®å½“ä¸­ã€‚Kubernetesæ˜¯é€šè¿‡kubeletè·ŸCRIè¿›è¡Œé€šä¿¡ã€‚
  OCIï¼ˆOpen Container Initiativeï¼‰ï¼šå…·ä½“çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ¯”å¦‚Dockeré¡¹ç›®ï¼Œåˆ™ä¸€èˆ¬é€šè¿‡OCIè¿™ä¸ªå®¹å™¨è¿è¡Œæ—¶è§„èŒƒåŒåº•å±‚çš„Linuxæ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œå³ï¼šæŠŠCRIè¯·æ±‚ç¿»è¯‘æˆå¯¹Linuxæ“ä½œç³»ç»Ÿçš„è°ƒç”¨ï¼ˆæ“ä½œLinux Namespaceå’ŒCgroupsç­‰ï¼‰ã€‚
 CRIæ˜¯k8så¯¹å¤–æš´éœ²çš„æŠ½è±¡å®¹å™¨æ¥å£ï¼ŒOCIæ˜¯å¼€å‘å®¹å™¨å€¡è®®ï¼Œæœ€ç»ˆCRIæ¥å£ä¼šè°ƒç”¨ç¬¦åˆOCIçš„ç³»ç»Ÿå†…æ ¸æ¥å£
å®¹å™¨ç”Ÿæ€ä¸‰å±‚æŠ½è±¡:
 Orchestration API -&amp;gt; Container API -&amp;gt; Kernel API
  Orchestration API: kubernetes APIæ ‡å‡†å°±æ˜¯è¿™å±‚çš„æ ‡å‡†,æ— å¯éè®® Container API: æ ‡å‡†å°±æ˜¯CRI Kernel API: æ ‡å‡†å°±æ˜¯OCI     CNIï¼ˆContainer Networking Interfaceï¼‰ï¼šè°ƒç”¨ç½‘ç»œæ’ä»¶åšç½‘ç»œé€šä¿¡ã€‚
  CSIï¼ˆContainer Storage Interfaceï¼‰ï¼šè°ƒç”¨å­˜å‚¨æ’ä»¶é…ç½®æŒä¹…åŒ–å­˜å‚¨ã€‚
  kubeletè¿˜é€šè¿‡gRPCåè®®åŒä¸€ä¸ªå«ä½œDevice Pluginçš„æ’ä»¶è¿›è¡Œäº¤äº’ã€‚
   ä»¥ä¸Šå‡ ç§æ¥å£éƒ½æ˜¯kubeletæ‰€è¦æ”¯æŒçš„åŠŸèƒ½ï¼Œæ‰€ä»¥è®¡ç®—èŠ‚ç‚¹ä¸Šæœ€æ ¸å¿ƒçš„ç»„ä»¶å°±æ˜¯kubeletã€‚
 </description>
    </item>
    
    <item>
      <title>k8sæ¶æ„</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E6%9E%B6%E6%9E%84/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E6%9E%B6%E6%9E%84/</guid>
      <description>Kubernetes ä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆ:
 etcd ä¿å­˜äº†æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ï¼Œå°±æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼› apiserver æä¾›äº†èµ„æºæ“ä½œçš„å”¯ä¸€å…¥å£ï¼Œå¹¶æä¾›è®¤è¯ã€æˆæƒã€è®¿é—®æ§åˆ¶ã€API æ³¨å†Œå’Œå‘ç°ç­‰æœºåˆ¶ï¼› controller manager è´Ÿè´£ç»´æŠ¤é›†ç¾¤çš„çŠ¶æ€ï¼Œæ¯”å¦‚æ•…éšœæ£€æµ‹ã€è‡ªåŠ¨æ‰©å±•ã€æ»šåŠ¨æ›´æ–°ç­‰ï¼› scheduler è´Ÿè´£èµ„æºçš„è°ƒåº¦ï¼ŒæŒ‰ç…§é¢„å®šçš„è°ƒåº¦ç­–ç•¥å°† Pod è°ƒåº¦åˆ°ç›¸åº”çš„æœºå™¨ä¸Šï¼› kubelet è´Ÿè´£ç»´æŠ¤å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒæ—¶ä¹Ÿè´Ÿè´£ Volumeï¼ˆCSIï¼‰å’Œç½‘ç»œï¼ˆCNIï¼‰çš„ç®¡ç†ï¼› Container runtime è´Ÿè´£é•œåƒç®¡ç†ä»¥åŠ Pod å’Œå®¹å™¨çš„çœŸæ­£è¿è¡Œï¼ˆCRIï¼‰ï¼› kube-proxy è´Ÿè´£ä¸º Service æä¾› cluster å†…éƒ¨çš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ï¼›  å½“ç„¶äº†é™¤äº†ä¸Šé¢çš„è¿™äº›æ ¸å¿ƒç»„ä»¶ï¼Œè¿˜æœ‰ä¸€äº›æ¨èçš„æ’ä»¶ï¼š
 kube-dns è´Ÿè´£ä¸ºæ•´ä¸ªé›†ç¾¤æä¾› DNS æœåŠ¡ Ingress Controller ä¸ºæœåŠ¡æä¾›å¤–ç½‘å…¥å£ Heapster æä¾›èµ„æºç›‘æ§ Dashboard æä¾› GUI  </description>
    </item>
    
    <item>
      <title>k8sç»„ä»¶</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E7%BB%84%E4%BB%B6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E7%BB%84%E4%BB%B6/</guid>
      <description>Masterï¼ˆæ§åˆ¶å¹³é¢ï¼‰ç»„ä»¶ 1âƒ£ï¸ kube-apiserver  æä¾›é›†ç¾¤ç®¡ç†çš„ REST API æ¥å£ï¼ŒåŒ…æ‹¬è®¤è¯æˆæƒã€æ•°æ®æ ¡éªŒä»¥åŠé›†ç¾¤çŠ¶æ€å˜æ›´ç­‰ æä¾›å…¶ä»–æ¨¡å—ä¹‹é—´çš„æ•°æ®äº¤äº’å’Œé€šä¿¡çš„æ¢çº½ï¼ˆå…¶ä»–æ¨¡å—é€šè¿‡ API Server æŸ¥è¯¢æˆ–ä¿®æ”¹æ•°æ®ï¼Œåªæœ‰ API Server æ‰ç›´æ¥æ“ä½œ etcdï¼‰  2âƒ£ï¸ etcd etcd æ˜¯ CoreOS åŸºäº Raft å¼€å‘çš„åˆ†å¸ƒå¼ key-value å­˜å‚¨ï¼Œå¯ç”¨äºæœåŠ¡å‘ç°ã€å…±äº«é…ç½®ä»¥åŠä¸€è‡´æ€§ä¿éšœï¼ˆå¦‚æ•°æ®åº“é€‰ä¸»ã€åˆ†å¸ƒå¼é”ç­‰ï¼‰ã€‚
ä¸»è¦åŠŸèƒ½ğŸ”§åŒ…æ‹¬ï¼š
 åŸºæœ¬çš„ key-value å­˜å‚¨ ç›‘å¬æœºåˆ¶ key çš„è¿‡æœŸåŠç»­çº¦æœºåˆ¶ï¼Œç”¨äºç›‘æ§å’ŒæœåŠ¡å‘ç° åŸå­ CAS å’Œ CADï¼Œç”¨äºåˆ†å¸ƒå¼é”å’Œ leader é€‰ä¸¾  Etcdï¼ŒZookeeperï¼ŒConsul æ¯”è¾ƒ ğŸ†šï¼š
 Etcd å’Œ Zookeeper æä¾›çš„èƒ½åŠ›éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šç”¨çš„ä¸€è‡´æ€§å…ƒä¿¡æ¯å­˜å‚¨ï¼Œéƒ½æä¾› watch æœºåˆ¶ç”¨äºå˜æ›´é€šçŸ¥å’Œåˆ†å‘ï¼Œä¹Ÿéƒ½è¢«åˆ†å¸ƒå¼ç³»ç»Ÿç”¨æ¥ä½œä¸ºå…±äº«ä¿¡æ¯å­˜å‚¨ï¼Œåœ¨è½¯ä»¶ç”Ÿæ€ä¸­æ‰€å¤„çš„ä½ç½®ä¹Ÿå‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥äº’ç›¸æ›¿ä»£çš„ã€‚äºŒè€…é™¤äº†å®ç°ç»†èŠ‚ï¼Œè¯­è¨€ï¼Œä¸€è‡´æ€§åè®®ä¸Šçš„åŒºåˆ«ï¼Œæœ€å¤§çš„åŒºåˆ«åœ¨å‘¨è¾¹ç”Ÿæ€åœˆã€‚Zookeeper æ˜¯ apache ä¸‹çš„ï¼Œç”¨ java å†™çš„ï¼Œæä¾› rpc æ¥å£ï¼Œæœ€æ—©ä» hadoop é¡¹ç›®ä¸­å­µåŒ–å‡ºæ¥ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¾—åˆ°å¹¿æ³›ä½¿ç”¨ï¼ˆhadoop, solr, kafka, mesos ç­‰ï¼‰ã€‚Etcd æ˜¯ coreos å…¬å¸æ——ä¸‹çš„å¼€æºäº§å“ï¼Œæ¯”è¾ƒæ–°ï¼Œä»¥å…¶ç®€å•å¥½ç”¨çš„ rest æ¥å£ä»¥åŠæ´»è·ƒçš„ç¤¾åŒºä¿˜è·äº†ä¸€æ‰¹ç”¨æˆ·ï¼Œåœ¨æ–°çš„ä¸€äº›é›†ç¾¤ä¸­å¾—åˆ°ä½¿ç”¨ï¼ˆæ¯”å¦‚ kubernetesï¼‰ã€‚è™½ç„¶ v3 ä¸ºäº†æ€§èƒ½ä¹Ÿæ”¹æˆäºŒè¿›åˆ¶ rpc æ¥å£äº†ï¼Œä½†å…¶æ˜“ç”¨æ€§ä¸Šæ¯” Zookeeper è¿˜æ˜¯å¥½ä¸€äº›ã€‚ è€Œ Consul çš„ç›®æ ‡åˆ™æ›´ä¸ºå…·ä½“ä¸€äº›ï¼ŒEtcd å’Œ Zookeeper æä¾›çš„æ˜¯åˆ†å¸ƒå¼ä¸€è‡´æ€§å­˜å‚¨èƒ½åŠ›ï¼Œå…·ä½“çš„ä¸šåŠ¡åœºæ™¯éœ€è¦ç”¨æˆ·è‡ªå·±å®ç°ï¼Œæ¯”å¦‚æœåŠ¡å‘ç°ï¼Œæ¯”å¦‚é…ç½®å˜æ›´ã€‚è€Œ Consul åˆ™ä»¥æœåŠ¡å‘ç°å’Œé…ç½®å˜æ›´ä¸ºä¸»è¦ç›®æ ‡ï¼ŒåŒæ—¶é™„å¸¦äº† kv å­˜å‚¨ã€‚  3âƒ£ï¸ kube-scheduler kube-scheduler è´Ÿè´£åˆ†é…è°ƒåº¦ Pod åˆ°é›†ç¾¤å†…çš„èŠ‚ç‚¹ä¸Šï¼Œå®ƒç›‘å¬ kube-apiserverï¼ŒæŸ¥è¯¢è¿˜æœªåˆ†é… Node çš„ Podï¼Œç„¶åæ ¹æ®è°ƒåº¦ç­–ç•¥ä¸ºè¿™äº› Pod åˆ†é…èŠ‚ç‚¹ï¼ˆæ›´æ–° Pod çš„ NodeName å­—æ®µï¼‰ã€‚</description>
    </item>
    
    <item>
      <title>k8sç»„ä»¶é—´é€šä¿¡</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1/</guid>
      <description>Kubernetes å¤šç»„ä»¶ä¹‹é—´çš„é€šä¿¡åŸç†ï¼š
 apiserver è´Ÿè´£ etcd å­˜å‚¨çš„æ‰€æœ‰æ“ä½œï¼Œä¸”åªæœ‰ apiserver æ‰ç›´æ¥æ“ä½œ etcd é›†ç¾¤ apiserver å¯¹å†…ï¼ˆé›†ç¾¤ä¸­çš„å…¶ä»–ç»„ä»¶ï¼‰å’Œå¯¹å¤–ï¼ˆç”¨æˆ·ï¼‰æä¾›ç»Ÿä¸€çš„ REST APIï¼Œå…¶ä»–ç»„ä»¶å‡é€šè¿‡ apiserver è¿›è¡Œé€šä¿¡  controller managerã€schedulerã€kube-proxy å’Œ kubelet ç­‰å‡é€šè¿‡ apiserver watch API ç›‘æµ‹èµ„æºå˜åŒ–æƒ…å†µï¼Œå¹¶å¯¹èµ„æºä½œç›¸åº”çš„æ“ä½œ æ‰€æœ‰éœ€è¦æ›´æ–°èµ„æºçŠ¶æ€çš„æ“ä½œå‡é€šè¿‡ apiserver çš„ REST API è¿›è¡Œ   apiserver ä¹Ÿä¼šç›´æ¥è°ƒç”¨ kubelet APIï¼ˆå¦‚ logs, exec, attach ç­‰ï¼‰ï¼Œé»˜è®¤ä¸æ ¡éªŒ kubelet è¯ä¹¦ï¼Œä½†å¯ä»¥é€šè¿‡ --kubelet-certificate-authority å¼€å¯ï¼ˆè€Œ GKE é€šè¿‡ SSH éš§é“ä¿æŠ¤å®ƒä»¬ä¹‹é—´çš„é€šä¿¡ï¼‰  æ¯”å¦‚æœ€å…¸å‹çš„åˆ›å»º Pod çš„æµç¨‹ï¼š
  é€šè¿‡ CLI æˆ–è€… UI æäº¤ Pod éƒ¨ç½²è¯·æ±‚ç»™ Kubernetes API Server
  API Server ä¼šæŠŠè¿™ä¸ªä¿¡æ¯å†™å…¥åˆ°å®ƒçš„å­˜å‚¨ç³»ç»Ÿ etcd</description>
    </item>
    
    <item>
      <title>k8séƒ¨ç½²åº”ç”¨(å‰ç«¯é™æ€)</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/k8s%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8%E5%89%8D%E7%AB%AF%E9%9D%99%E6%80%81/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/k8s%E9%83%A8%E7%BD%B2%E5%BA%94%E7%94%A8%E5%89%8D%E7%AB%AF%E9%9D%99%E6%80%81/</guid>
      <description>k8séƒ¨ç½²åº”ç”¨(å‰ç«¯é™æ€)
0. å‡†å¤‡æ¡ä»¶  éƒ¨ç½²å¥½äº†k8sé›†ç¾¤ï¼Œéƒ¨ç½²å¯ä»¥å‚è€ƒKubernetes: ä»é›¶æ­å»ºK8S     åç§° æ•°é‡ IP å¤‡æ³¨     master 1 172.17.0.14 æ“ä½œç³»ç»Ÿ: Linux(centos7, å…¶å®ƒæ“ä½œç³»ç»Ÿä¹Ÿå¯, å®‰è£…è¿‡ç¨‹ç±»ä¼¼, å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£) æœºå™¨é…ç½®: 4C8G   node1 1 172.18.0.7 åŒä¸Š   node2 1 172.19.0.5 åŒä¸Š     åº”ç”¨å·²ç»å®¹å™¨åŒ–ï¼Œå¹¶ä¸Šä¼ åˆ°äº†è¿œç¨‹ä»“åº“ï¼Œç¬”è€…æ˜¯è…¾è®¯äº‘å®¹å™¨ä»“åº“ï¼š   ç†è§£k8såŸºç¡€æ¦‚å¿µï¼Œå¯ä»¥å‚è€ƒKubernetes: åŸºç¡€æ¦‚å¿µä»‹ç»
  1. æ§åˆ¶å™¨ç®¡ç†Pod 1.1 ç”Ÿæˆdeploymenté…ç½®æ–‡ä»¶ kubectl create deployment yshop-h5 --image=ccr.ccs.tencentyun.com/yshop/h5 --dry-run -o yaml &amp;gt; yshop-h5.yaml è¿™ä¸ªæ—¶å€™k8sè¿˜ä¸èƒ½æ‹‰å–é•œåƒï¼Œéœ€è¦ç”Ÿæˆæ‹‰å–é•œåƒçš„å¯†é’¥ã€‚
1.2 ç”Ÿæˆæ‹‰å–é•œåƒçš„å¯†é’¥ kubectl create secret docker-registry registry-secret-tencent --docker-server=ccr.</description>
    </item>
    
    <item>
      <title>nfså®‰è£…</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/nfs%E5%AE%89%E8%A3%85/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/nfs%E5%AE%89%E8%A3%85/</guid>
      <description>nfså®‰è£…
1. ç¯å¢ƒè¯´æ˜    è§’è‰² ip os     NFS æœåŠ¡ç«¯ 172.31.0.12 CentOS 7.6   NFS å®¢æˆ·ç«¯ 172.18.0.7 CentOS 7.6    2. NFS æœåŠ¡ç«¯ 2.1 å®‰è£… nfs-utils # rpcbind ä½œä¸ºä¾èµ–ä¼šè‡ªåŠ¨å®‰è£…ã€‚ &amp;gt; yum install nfs-utils 2.2 é…ç½®å¹¶å¯åŠ¨æœåŠ¡ å…è®¸rpcbind.serviceã€nfs.serviceå¼€æœºè‡ªå¯ï¼š
# å¯åŠ¨ç›¸å…³æœåŠ¡ &amp;gt; systemctl start rpcbind &amp;gt; systemctl start nfs é˜²ç«å¢™å…è®¸æœåŠ¡é€šè¿‡ï¼š
# é˜²ç«å¢™å…è®¸æœåŠ¡é€šè¿‡ &amp;gt; firewall-cmd --zone=public --permanent --add-service={rpc-bind,mountd,nfs} success  &amp;gt; firewall-cmd --reload success æˆ–è€…ç›´æ¥å…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld</description>
    </item>
    
    <item>
      <title>operatorå®æˆ˜</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/operator%E5%AE%9E%E6%88%98/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/operator%E5%AE%9E%E6%88%98/</guid>
      <description>operatorå®æˆ˜ 1âƒ£ï¸ éœ€æ±‚ æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ª crd ï¼Œspec åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š
Replicas	# å‰¯æœ¬æ•° Image	# é•œåƒ Resources	# èµ„æºé™åˆ¶ Envs	# ç¯å¢ƒå˜é‡ Ports	# æœåŠ¡ç«¯å£ 2âƒ£ï¸ ç¼–ç  åˆå§‹åŒ–é¡¹ç›®ç›®å½•ï¼š
tony@192 k8s % pwd /Users/tony/workspace/k8s tony@192 k8s % mkdir -p app-operator/src/github.com/xuzhijvn/app cd app-operator/src/github.com/xuzhijvn/app åˆå§‹åŒ–operatoré¡¹ç›®ç»“æ„ï¼Œå¹¶åˆ›å»ºapiï¼š
 operator-sdk init --domain=huolala.cn --repo=github.com/xuzhijvn/app  operator-sdk create api --group app --version v1 --kind App --resource=true --controller=true ä¿®æ”¹ CRD ç±»å‹å®šä¹‰ä»£ç  api/v1/app_types.go:
/* Copyright 2021. Licensed under the Apache License, Version 2.0 (the &amp;#34;License&amp;#34;); you may not use this file except in compliance with the License.</description>
    </item>
    
    <item>
      <title>PV/PVC/StorageClass</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pv-pvc-storageclass/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/pv-pvc-storageclass/</guid>
      <description>æœ¬æ–‡è¾ƒè€ï¼Œå»ºè®®æŸ¥çœ‹æ–°æ–‡æ¡£ï¼šhttp://docs.kubernetes.org.cn/429.html ä»‹ç» PersistentVolumeï¼ˆPVï¼‰æ˜¯é›†ç¾¤ä¸­å·²ç”±ç®¡ç†å‘˜é…ç½®çš„ä¸€æ®µç½‘ç»œå­˜å‚¨ã€‚ é›†ç¾¤ä¸­çš„èµ„æºå°±åƒä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªé›†ç¾¤èµ„æºã€‚ PVæ˜¯è¯¸å¦‚å·ä¹‹ç±»çš„å·æ’ä»¶ï¼Œä½†æ˜¯å…·æœ‰ç‹¬ç«‹äºä½¿ç”¨PVçš„ä»»ä½•å•ä¸ªpodçš„ç”Ÿå‘½å‘¨æœŸã€‚ è¯¥APIå¯¹è±¡æ•è·å­˜å‚¨çš„å®ç°ç»†èŠ‚ï¼Œå³NFSï¼ŒiSCSIæˆ–äº‘æä¾›å•†ç‰¹å®šçš„å­˜å‚¨ç³»ç»Ÿã€‚
PersistentVolumeClaimï¼ˆPVCï¼‰æ˜¯ç”¨æˆ·å­˜å‚¨çš„è¯·æ±‚ã€‚ å®ƒç±»ä¼¼äºpodã€‚Podæ¶ˆè€—èŠ‚ç‚¹èµ„æºï¼ŒPVCæ¶ˆè€—å­˜å‚¨èµ„æºã€‚ podå¯ä»¥è¯·æ±‚ç‰¹å®šçº§åˆ«çš„èµ„æºï¼ˆCPUå’Œå†…å­˜ï¼‰ã€‚ æƒé™è¦æ±‚å¯ä»¥è¯·æ±‚ç‰¹å®šçš„å¤§å°å’Œè®¿é—®æ¨¡å¼ã€‚
è™½ç„¶PersistentVolumeClaimså…è®¸ç”¨æˆ·ä½¿ç”¨æŠ½è±¡å­˜å‚¨èµ„æºï¼Œä½†æ˜¯å¸¸è§çš„æ˜¯ï¼Œç”¨æˆ·éœ€è¦å…·æœ‰ä¸åŒå±æ€§ï¼ˆå¦‚æ€§èƒ½ï¼‰çš„PersistentVolumesï¼Œç”¨äºä¸åŒçš„é—®é¢˜ã€‚ ç¾¤é›†ç®¡ç†å‘˜éœ€è¦èƒ½å¤Ÿæä¾›å¤šç§ä¸åŒäºPersistentVolumesçš„PersistentVolumesï¼Œè€Œä¸ä»…ä»…æ˜¯å¤§å°å’Œè®¿é—®æ¨¡å¼ï¼Œè€Œä¸ä¼šä½¿ç”¨æˆ·äº†è§£è¿™äº›å·çš„å®ç°ç»†èŠ‚ã€‚ å¯¹äºè¿™äº›éœ€æ±‚ï¼Œå­˜åœ¨StorageClassèµ„æºã€‚
StorageClassä¸ºç®¡ç†å‘˜æä¾›äº†ä¸€ç§æè¿°ä»–ä»¬æä¾›çš„å­˜å‚¨çš„â€œç±»â€çš„æ–¹æ³•ã€‚ ä¸åŒçš„ç±»å¯èƒ½æ˜ å°„åˆ°æœåŠ¡è´¨é‡çº§åˆ«ï¼Œæˆ–å¤‡ä»½ç­–ç•¥ï¼Œæˆ–è€…ç”±ç¾¤é›†ç®¡ç†å‘˜ç¡®å®šçš„ä»»æ„ç­–ç•¥ã€‚ Kubernetesæœ¬èº«å¯¹äºä»€ä¹ˆç±»åˆ«ä»£è¡¨æ˜¯ä¸è¨€è€Œå–»çš„ã€‚ è¿™ä¸ªæ¦‚å¿µæœ‰æ—¶åœ¨å…¶ä»–å­˜å‚¨ç³»ç»Ÿä¸­ç§°ä¸ºâ€œé…ç½®æ–‡ä»¶â€
ä¾‹å­ https://kubernetes.io/docs/user-guide/persistent-volumes/walkthrough/
Lifecycle of a volume and claim PVæ˜¯é›†ç¾¤ä¸­çš„èµ„æºã€‚ PVCæ˜¯å¯¹è¿™äº›èµ„æºçš„è¯·æ±‚ï¼Œä¹Ÿæ˜¯å¯¹èµ„æºçš„ç´¢èµ”æ£€æŸ¥ã€‚ PVå’ŒPVCä¹‹é—´çš„ç›¸äº’ä½œç”¨éµå¾ªè¿™ä¸ªç”Ÿå‘½å‘¨æœŸ:
Provisioning â€”â€”-&amp;gt; Binding â€”â€”â€“&amp;gt;Usingâ€”â€”&amp;gt;Releasingâ€”â€”&amp;gt;Recycling
Provisioning è¿™é‡Œæœ‰ä¸¤ç§PVçš„æä¾›æ–¹å¼:é™æ€æˆ–è€…åŠ¨æ€
Static é›†ç¾¤ç®¡ç†å‘˜åˆ›å»ºå¤šä¸ªPVã€‚ å®ƒä»¬æºå¸¦å¯ä¾›é›†ç¾¤ç”¨æˆ·ä½¿ç”¨çš„çœŸå®å­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ã€‚ å®ƒä»¬å­˜åœ¨äºKubernetes APIä¸­ï¼Œå¯ç”¨äºæ¶ˆè´¹ã€‚ Dynamic å½“ç®¡ç†å‘˜åˆ›å»ºçš„é™æ€PVéƒ½ä¸åŒ¹é…ç”¨æˆ·çš„PersistentVolumeClaimæ—¶ï¼Œé›†ç¾¤å¯èƒ½ä¼šå°è¯•ä¸ºPVCåŠ¨æ€é…ç½®å·ã€‚ æ­¤é…ç½®åŸºäºStorageClassesï¼šPVCå¿…é¡»è¯·æ±‚ä¸€ä¸ªç±»ï¼Œå¹¶ä¸”ç®¡ç†å‘˜å¿…é¡»å·²åˆ›å»ºå¹¶é…ç½®è¯¥ç±»æ‰èƒ½è¿›è¡ŒåŠ¨æ€é…ç½®ã€‚ è¦æ±‚è¯¥ç±»çš„å£°æ˜æœ‰æ•ˆåœ°ä¸ºè‡ªå·±ç¦ç”¨åŠ¨æ€é…ç½® Binding åœ¨åŠ¨æ€é…ç½®çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·åˆ›å»ºæˆ–å·²ç»åˆ›å»ºäº†å…·æœ‰ç‰¹å®šæ•°é‡çš„å­˜å‚¨è¯·æ±‚å’Œç‰¹å®šè®¿é—®æ¨¡å¼çš„PersistentVolumeClaimã€‚ ä¸»æœºä¸­çš„æ§åˆ¶å›è·¯ç›‘è§†æ–°çš„PVCï¼Œæ‰¾åˆ°åŒ¹é…çš„PVï¼ˆå¦‚æœå¯èƒ½ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ç»‘å®šåœ¨ä¸€èµ·ã€‚ å¦‚æœä¸ºæ–°çš„PVCåŠ¨æ€é…ç½®PVï¼Œåˆ™å¾ªç¯å°†å§‹ç»ˆå°†è¯¥PVç»‘å®šåˆ°PVCã€‚ å¦åˆ™ï¼Œç”¨æˆ·æ€»æ˜¯è‡³å°‘å¾—åˆ°ä»–ä»¬è¦æ±‚çš„å†…å®¹ï¼Œä½†æ˜¯å·å¯èƒ½è¶…å‡ºäº†è¦æ±‚ã€‚ ä¸€æ—¦ç»‘å®šï¼ŒPersistentVolumeClaimç»‘å®šæ˜¯æ’ä»–çš„ï¼Œä¸ç®¡ç”¨äºç»‘å®šå®ƒä»¬çš„æ¨¡å¼ã€‚
å¦‚æœåŒ¹é…çš„å·ä¸å­˜åœ¨ï¼ŒPVCå°†ä¿æŒæ— é™æœŸã€‚ éšç€åŒ¹é…å·å˜å¾—å¯ç”¨ï¼ŒPVCå°†è¢«ç»‘å®šã€‚ ä¾‹å¦‚ï¼Œæä¾›è®¸å¤š50Gi PVçš„é›†ç¾¤å°†ä¸åŒ¹é…è¦æ±‚100Giçš„PVCã€‚ å½“é›†ç¾¤ä¸­æ·»åŠ 100Gi PVæ—¶ï¼Œå¯ä»¥ç»‘å®šPVCã€‚
Using Podä½¿ç”¨PVCä½œä¸ºå·ã€‚ é›†ç¾¤æ£€æŸ¥å£°æ˜ä»¥æ‰¾åˆ°ç»‘å®šçš„å·å¹¶æŒ‚è½½è¯¥å·çš„å·ã€‚ å¯¹äºæ”¯æŒå¤šç§è®¿é—®æ¨¡å¼çš„å·ï¼Œç”¨æˆ·åœ¨å°†å…¶å£°æ˜ç”¨ä½œpodä¸­çš„å·æ—¶æŒ‡å®šæ‰€éœ€çš„æ¨¡å¼ã€‚
ä¸€æ—¦ç”¨æˆ·æœ‰å£°æ˜å¹¶ä¸”è¯¥å£°æ˜è¢«ç»‘å®šï¼Œç»‘å®šçš„PVå±äºç”¨æˆ·ï¼Œåªè¦ä»–ä»¬éœ€è¦å®ƒã€‚ ç”¨æˆ·é€šè¿‡åœ¨å…¶Podçš„å·å—ä¸­åŒ…å«persistentVolumeClaimæ¥å®‰æ’Podså¹¶è®¿é—®å…¶å£°æ˜çš„PVã€‚
Releasing å½“ç”¨æˆ·å®Œæˆå·æ—¶ï¼Œä»–ä»¬å¯ä»¥ä»å…è®¸èµ„æºå›æ”¶çš„APIä¸­åˆ é™¤PVCå¯¹è±¡ã€‚ å½“å£°æ˜è¢«åˆ é™¤æ—¶ï¼Œå·è¢«è®¤ä¸ºæ˜¯â€œé‡Šæ”¾çš„â€ï¼Œä½†æ˜¯å®ƒè¿˜ä¸èƒ½ç”¨äºå¦ä¸€ä¸ªå£°æ˜ã€‚ ä»¥å‰çš„ç´¢èµ”äººçš„æ•°æ®ä»ç„¶ä¿ç•™åœ¨å¿…é¡»æ ¹æ®æ”¿ç­–å¤„ç†çš„å·ä¸Š.
Reclaiming PersistentVolumeçš„å›æ”¶ç­–ç•¥å‘Šè¯‰é›†ç¾¤åœ¨é‡Šæ”¾å…¶å£°æ˜åï¼Œè¯¥å·åº”è¯¥å¦‚ä½•å¤„ç†ã€‚ ç›®å‰ï¼Œå·å¯ä»¥æ˜¯ä¿ç•™ï¼Œå›æ”¶æˆ–åˆ é™¤ã€‚ ä¿ç•™å¯ä»¥æ‰‹åŠ¨å›æ”¶èµ„æºã€‚ å¯¹äºé‚£äº›æ”¯æŒå®ƒçš„å·æ’ä»¶ï¼Œåˆ é™¤å°†ä»Kubernetesä¸­åˆ é™¤PersistentVolumeå¯¹è±¡ï¼Œä»¥åŠåˆ é™¤å¤–éƒ¨åŸºç¡€æ¶æ„ï¼ˆå¦‚AWS EBSï¼ŒGCE PDï¼ŒAzure Diskæˆ–Cinderå·ï¼‰ä¸­å…³è”çš„å­˜å‚¨èµ„äº§ã€‚ åŠ¨æ€é…ç½®çš„å·å§‹ç»ˆè¢«åˆ é™¤</description>
    </item>
    
    <item>
      <title>pvcä¸ä¼šä¸»åŠ¨å›æ”¶é—®é¢˜</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/pvc%E4%B8%8D%E4%BC%9A%E4%B8%BB%E5%8A%A8%E5%9B%9E%E6%94%B6%E9%97%AE%E9%A2%98/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/pvc%E4%B8%8D%E4%BC%9A%E4%B8%BB%E5%8A%A8%E5%9B%9E%E6%94%B6%E9%97%AE%E9%A2%98/</guid>
      <description>pvcä¸ä¼šä¸»åŠ¨å›æ”¶é—®é¢˜
ä½¿ç”¨k8séƒ¨ç½²nacosçš„æ—¶å€™å‘ç°ï¼Œé€šè¿‡volumeClaimTemplatesé…ç½®çš„pvcä¸ä¼šéšç€ä½¿ç”¨kubectl delete -f xxx.yaml åˆ é™¤StatefulSetçš„æ—¶å€™ä¸€åŒè¢«åˆ é™¤ã€‚nacos-pvc-nfs.yamlæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š
--- apiVersion: v1 kind: Service metadata:  name: nacos-headless  labels:  app: nacos  annotations:  service.alpha.kubernetes.io/tolerate-unready-endpoints: &amp;#34;true&amp;#34; spec:  ports:  - port: 8848  name: server  targetPort: 8848  - port: 7848  name: rpc  targetPort: 7848  clusterIP: None  selector:  app: nacos --- apiVersion: v1 kind: ConfigMap metadata:  name: nacos-cm data:  mysql.db.name: &amp;#34;nacos_devtest&amp;#34;  mysql.</description>
    </item>
    
    <item>
      <title>Services</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/services/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E8%B5%84%E6%BA%90%E5%AF%B9%E8%B1%A1/services/</guid>
      <description>Overviewï¼ˆæ¦‚è¿°ï¼‰ Kubernetes Podæ˜¯å¹³å‡¡çš„ï¼Œå®ƒé—¨ä¼šè¢«åˆ›å»ºï¼Œä¹Ÿä¼šæ­»æ‰ï¼ˆç”Ÿè€ç—…æ­»ï¼‰ï¼Œå¹¶ä¸”ä»–ä»¬æ˜¯ä¸å¯å¤æ´»çš„ã€‚ ReplicationControllersåŠ¨æ€çš„åˆ›å»ºå’Œé”€æ¯Pods(æ¯”å¦‚è§„æ¨¡æ‰©å¤§æˆ–è€…ç¼©å°ï¼Œæˆ–è€…æ‰§è¡ŒåŠ¨æ€æ›´æ–°)ã€‚æ¯ä¸ªpodéƒ½ç”±è‡ªå·±çš„ipï¼Œè¿™äº›IPä¹Ÿéšç€æ—¶é—´çš„å˜åŒ–ä¹Ÿä¸èƒ½æŒç»­ä¾èµ–ã€‚è¿™æ ·å°±å¼•å‘äº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä¸€äº›Podsï¼ˆè®©æˆ‘ä»¬å«å®ƒä½œåå°ï¼Œåç«¯ï¼‰æä¾›äº†ä¸€äº›åŠŸèƒ½ä¾›å…¶å®ƒçš„Podä½¿ç”¨ï¼ˆè®©æˆ‘ä»¬å«ä½œå‰å°ï¼‰ï¼Œåœ¨kuberneteé›†ç¾¤ä¸­æ˜¯å¦‚ä½•å®ç°è®©è¿™äº›å‰å°èƒ½å¤ŸæŒç»­çš„è¿½è¸ªåˆ°è¿™äº›åå°çš„ï¼Ÿ
ç­”æ¡ˆæ˜¯ï¼šService
Kubernete Service æ˜¯ä¸€ä¸ªå®šä¹‰äº†ä¸€ç»„Podçš„ç­–ç•¥çš„æŠ½è±¡ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰æ—¶å€™å«åšå®è§‚æœåŠ¡ã€‚è¿™äº›è¢«æœåŠ¡æ ‡è®°çš„Podéƒ½æ˜¯ï¼ˆä¸€èˆ¬ï¼‰é€šè¿‡label Selectorå†³å®šçš„ï¼ˆä¸‹é¢æˆ‘ä»¬ä¼šè®²åˆ°æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªæ²¡æœ‰label selectorçš„æœåŠ¡ï¼‰
ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å‡è®¾åå°æ˜¯ä¸€ä¸ªå›¾å½¢å¤„ç†çš„åå°ï¼Œå¹¶ä¸”ç”±3ä¸ªå‰¯æœ¬ã€‚è¿™äº›å‰¯æœ¬æ˜¯å¯ä»¥ç›¸äº’æ›¿ä»£çš„ï¼Œå¹¶ä¸”å‰å°å¹¶éœ€è¦å…³å¿ƒä½¿ç”¨çš„å“ªä¸€ä¸ªåå°Podï¼Œå½“è¿™ä¸ªæ‰¿è½½å‰å°è¯·æ±‚çš„podå‘ç”Ÿå˜åŒ–æ—¶ï¼Œå‰å°å¹¶ä¸éœ€è¦ç›´åˆ°è¿™äº›å˜åŒ–ï¼Œæˆ–è€…è¿½è¸ªåå°çš„è¿™äº›å‰¯æœ¬ï¼ŒæœåŠ¡æ˜¯è¿™äº›å»è€¦
å¯¹äºKuberneteåŸç”Ÿçš„åº”ç”¨ï¼ŒKuberneteæä¾›äº†ä¸€ä¸ªç®€å•çš„Endpoints APIï¼Œè¿™ä¸ªEndpoints apiçš„ä½œç”¨å°±æ˜¯å½“ä¸€ä¸ªæœåŠ¡ä¸­çš„podå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒEndpoints APIéšä¹‹å˜åŒ–ï¼Œå¯¹äºå“ªäº›ä¸æ˜¯åŸç”Ÿçš„ç¨‹åºï¼ŒKubernetesæä¾›äº†ä¸€ä¸ªåŸºäºè™šæ‹ŸIPçš„ç½‘æ¡¥çš„æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡ä¼šå°†è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„åå°pod
Defining a service(å®šä¹‰ä¸€ä¸ªæœåŠ¡) ä¸€ä¸ªKuberneteæœåŠ¡æ˜¯ä¸€ä¸ªæœ€å°çš„å¯¹è±¡ï¼Œç±»ä¼¼pod,å’Œå…¶å®ƒçš„ç»ˆç«¯å¯¹è±¡ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æœpaiserverå‘é€è¯·æ±‚æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ¯”å¦‚ï¼Œå‡è®¾ä½ æ‹¥æœ‰ä¸€äº›Pod,æ¯ä¸ªpodéƒ½å¼€æ”¾äº†9376ç«¯å£ï¼Œå¹¶ä¸”å‡å¸¦æœ‰ä¸€ä¸ªæ ‡ç­¾app=MyApp
{  &amp;#34;â€œkindâ€&amp;#34;: &amp;#34;â€œServiceâ€&amp;#34;,  &amp;#34;â€œapiVersionâ€&amp;#34;: &amp;#34;â€œv1â€&amp;#34;,  &amp;#34;â€œmetadataâ€&amp;#34;: {  &amp;#34;â€œnameâ€&amp;#34;: &amp;#34;â€œmy-serviceâ€&amp;#34;  },  &amp;#34;â€œspecâ€&amp;#34;: {  &amp;#34;â€œselectorâ€&amp;#34;: {  &amp;#34;â€œappâ€&amp;#34;: &amp;#34;â€œMyAppâ€&amp;#34;  },  &amp;#34;â€œportsâ€&amp;#34;: [  {  &amp;#34;â€œprotocolâ€&amp;#34;: &amp;#34;â€œTCPâ€&amp;#34;,  &amp;#34;â€œportâ€&amp;#34;: 80,  &amp;#34;â€œtargetPortâ€&amp;#34;: 9376  }  ]  } } è¿™æ®µä»£ç ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æœåŠ¡å¯¹è±¡ï¼Œåç§°ä¸ºï¼šmy-serviceï¼Œå¹¶ä¸”ä¼šè¿æ¥ç›®æ ‡ç«¯å£9376ï¼Œå¹¶ä¸”å¸¦æœ‰label app=MyAppçš„pod,è¿™ä¸ªæœåŠ¡ä¼šè¢«åˆ†é…ä¸€ä¸ªipåœ°å€ï¼Œè¿™ä¸ªipæ˜¯ç»™æœåŠ¡ä»£ç†ä½¿ç”¨çš„ï¼ˆä¸‹é¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼‰ï¼ŒæœåŠ¡çš„é€‰æ‹©å™¨ä¼šæŒç»­çš„è¯„ä¼°ï¼Œå¹¶ä¸”ç»“æœä¼šè¢«å‘é€åˆ°ä¸€ä¸ªEndpoints å¯¹è±¡ï¼Œè¿™ä¸ªEndpointsçš„å¯¹è±¡çš„åå­—ä¹Ÿå«â€œmy-serviceâ€.
æœåŠ¡å¯ä»¥å°†ä¸€ä¸ªâ€œå…¥ç«¯å£â€è½¬å‘åˆ°ä»»ä½•â€œç›®æ ‡ç«¯å£â€ï¼Œé»˜è®¤æƒ…å†µä¸‹targetPortçš„å€¼ä¼šå’Œportçš„å€¼ç›¸åŒï¼Œæ›´æœ‰è¶£çš„æ˜¯ï¼ŒtargetPortå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥æŒ‡å®šåˆ°ä¸€ä¸ªname,è¿™ä¸ªnameæ˜¯podçš„ä¸€ä¸ªç«¯å£ã€‚å¹¶ä¸”å®é™…æŒ‡æ´¾ç»™è¿™ä¸ªnameçš„ç«¯å£å¯ä»¥æ˜¯ä¸åŒåœ¨ä¸åŒçš„åå°podä¸­ï¼Œè¿™æ ·è®©æˆ‘ä»¬èƒ½æ›´åŠ çµæ´»çš„éƒ¨ç½²æˆ‘ä»¬çš„æœåŠ¡ï¼Œæ¯”å¦‚ï¼›æˆ‘ä»¬å¯ä»¥åœ¨ä¸‹ä¸€ä¸ªæ›´æ–°ç‰ˆæœ¬ä¸­ä¿®æ”¹åå°podæš´éœ²çš„ç«¯å£è€Œä¸ä¼šå½±å“å®¢æˆ·çš„ä½¿ç”¨ï¼ˆæ›´æ–°è¿‡ç¨‹ä¸ä¼šæ‰“æ–­ï¼‰</description>
    </item>
    
    <item>
      <title>ä¸€äº›æ¦‚å¿µ</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/</guid>
      <description>ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿï¼Ÿ äº‘åŸç”Ÿæ˜¯ä¸€ç§æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„æ–¹æ³•ï¼Œæ˜¯ä¸€å¥—æŠ€æœ¯ä½“ç³»å’Œæ–¹æ³•è®ºã€‚äº‘åŸç”Ÿï¼ˆCloudNativeï¼‰æ˜¯ä¸€ä¸ªç»„åˆè¯ï¼ŒCloud+Nativeã€‚Cloudè¡¨ç¤ºåº”ç”¨ç¨‹åºä½äºäº‘ä¸­ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„æ•°æ®ä¸­å¿ƒï¼›Nativeè¡¨ç¤ºåº”ç”¨ç¨‹åºä»è®¾è®¡ä¹‹åˆå³è€ƒè™‘åˆ°äº‘çš„ç¯å¢ƒï¼ŒåŸç”Ÿä¸ºäº‘è€Œè®¾è®¡ï¼Œåœ¨äº‘ä¸Šä»¥æœ€ä½³å§¿åŠ¿è¿è¡Œï¼Œå……åˆ†åˆ©ç”¨å’Œå‘æŒ¥äº‘å¹³å°çš„å¼¹æ€§+åˆ†å¸ƒå¼ä¼˜åŠ¿ã€‚
 ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿæ¶æ„ï¼Ÿ é‡‡ç”¨å¼€æºå †æ ˆï¼ˆK8S+Dockerï¼‰è¿›è¡Œå®¹å™¨åŒ–ï¼ŒåŸºäºå¾®æœåŠ¡æ¶æ„æé«˜çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå€ŸåŠ©æ•æ·æ–¹æ³•ã€DevOpsæ”¯æŒæŒç»­è¿­ä»£å’Œè¿ç»´è‡ªåŠ¨åŒ–ï¼Œåˆ©ç”¨äº‘å¹³å°è®¾æ–½å®ç°å¼¹æ€§ä¼¸ç¼©ã€åŠ¨æ€è°ƒåº¦ã€ä¼˜åŒ–èµ„æºåˆ©ç”¨ç‡ã€‚
ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿåº”ç”¨ï¼Ÿ åœ¨æ¶æ„è®¾è®¡ã€å¼€å‘æ–¹å¼ã€éƒ¨ç½²ç»´æŠ¤ç­‰å„ä¸ªé˜¶æ®µå’Œæ–¹é¢éƒ½åŸºäºäº‘çš„ç‰¹ç‚¹å»ºè®¾çš„åº”ç”¨ã€‚
 ä»€ä¹ˆæ˜¯å®¹å™¨ç¼–æ’ï¼Ÿ å®¹å™¨ç¼–æ’æ˜¯æŒ‡è‡ªåŠ¨åŒ–å®¹å™¨çš„éƒ¨ç½²ã€ç®¡ç†ã€æ‰©å±•å’Œè”ç½‘ã€‚
 k8så‘¨è¾¹ï¼š
 k3s : è½»é‡åŒ–k8s k9s : kubectlå‘½ä»¤çš„å°è£… KubeOperator : å›½äº§k8så‘è¡Œç‰ˆ Kubesphere : k8sä¼ä¸šçº§åˆ«å¢å¼ºï¼ˆå¤šäº‘ã€å¤šé›†ç¾¤ï¼‰ kubeedge : è¾¹ç¼˜è®¡ç®— Kubeless : é¢å‘serverlessçš„k8s   ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼ï¼Ÿ k8s/istioä¸äº‘åŸç”Ÿçš„å…³ç³»ï¼Ÿ </description>
    </item>
    
    <item>
      <title>äº‘å‚å•†é›†æˆk8s</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/%E4%BA%91%E5%8E%82%E5%95%86%E9%9B%86%E6%88%90k8s/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/%E4%BA%91%E5%8E%82%E5%95%86%E9%9B%86%E6%88%90k8s/</guid>
      <description>é˜¿é‡Œäº‘ ACK è…¾è®¯äº‘ TKE åä¸ºäº‘ CCE AWS EKS Google GKE Azure AKS DigitalOcean k8s Oracle OKE</description>
    </item>
    
    <item>
      <title>ä»é›¶æ­å»ºK8S</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAk8s/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BAk8s/</guid>
      <description>ä»é›¶æ­å»ºK8S
æœºå™¨å‡†å¤‡    åç§° æ•°é‡ IP å¤‡æ³¨     master 1 172.17.0.14 æ“ä½œç³»ç»Ÿ: Linux(centos7, å…¶å®ƒæ“ä½œç³»ç»Ÿä¹Ÿå¯, å®‰è£…è¿‡ç¨‹ç±»ä¼¼, å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£) æœºå™¨é…ç½®: 4C8G   node1 1 172.18.0.7 åŒä¸Š   node2 1 172.19.0.5 åŒä¸Š    ç”±äºæœ¬äººå¾ˆç©·ï¼Œè¿™å‡ å°æœºå™¨æ˜¯åˆ†åˆ«å±äºä¸åŒçš„è…¾è®¯äº‘è´¦å·ï¼Œä¸åŒçš„è´¦å·ä¹‹é—´ä¸èƒ½å†…ç½‘é€šä¿¡ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡å»ºç«‹â€œå¯¹ç­‰è¿æ¥â€å®ç°é€šä¿¡ï¼Œæ¯”ç›´æ¥ç”¨å…¬ç½‘é€šä¿¡é è°±ã€‚
1. ä¿®æ”¹hostname [root@k8s-master ~]$ vim /etc/hostname # ä¿®æ”¹hostname [root@k8s-master ~]$ vim /etc/hosts	# å°†æœ¬æœºIPæŒ‡å‘hostname [root@k8s-master ~]$ reboot -h # é‡å¯(å¯ä»¥åšå®Œå…¨éƒ¨å‰æœŸå‡†å¤‡åå†é‡å¯) ä¿®æ”¹åï¼š
[root@k8s-master ~]# cat /etc/hosts  ::1 VM_0_5_centos VM_0_5_centos ::1 localhost.localdomain localhost ::1 localhost6.</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨kubeadmæ›´æ–°k8sè¯ä¹¦</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E4%BD%BF%E7%94%A8kubeadm%E6%9B%B4%E6%96%B0k8s%E8%AF%81%E4%B9%A6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E4%BD%BF%E7%94%A8kubeadm%E6%9B%B4%E6%96%B0k8s%E8%AF%81%E4%B9%A6/</guid>
      <description>ä½¿ç”¨kubeadmæ›´æ–°k8sè¯ä¹¦ ä»Šå¤©æ“ä½œk8sçš„æ—¶å€™ï¼Œçªç„¶è¯´è¯ä¹¦æ— æ•ˆï¼š
Unable to connect to the server: x509: certificate has expired or is not yet valid é€šè¿‡ kubeadm alpha certs check-expiration æŸ¥çœ‹ï¼Œç¡®å®æ˜¯è¿‡æœŸäº†ï¼š
[root@k8s-master ~]# kubeadm alpha certs check-expiration [check-expiration] Reading configuration from the cluster... [check-expiration] FYI: You can look at this config file with &amp;#39;kubectl -n kube-system get cm kubeadm-config -oyaml&amp;#39; [check-expiration] Error reading configuration from the Cluster. Falling back to default configuration  W0627 11:21:35.745166 8754 configset.go:202] WARNING: kubeadm cannot validate component configs for API groups [kubelet.</description>
    </item>
    
    <item>
      <title>åˆ‡æ¢namespace</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%88%87%E6%8D%A2namespace/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%88%87%E6%8D%A2namespace/</guid>
      <description>åˆ‡æ¢namespace
0. èƒŒæ™¯ k8så¦‚ä½•åˆ‡æ¢namespaceï¼Ÿï¼Ÿè€Œä¸å¿…æ¯æ¬¡æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™åœ¨åé¢æŒ‡å®šnamespaceï¼Ÿk8så¹¶æ²¡æœ‰ç›´æ¥æä¾›åˆ‡æ¢namespaceçš„å‘½ä»¤ã€‚ä¸è¿‡å¯ä»¥é€šè¿‡ï¼š
 åˆ‡æ¢contextè¾¾åˆ°åˆ‡æ¢namespaceçš„ç›®çš„ï¼Œè¿™éœ€è¦æå‰åˆ›å»ºå¥½contextå’Œnamespaceçš„ç»‘å®šå…³ç³»ï¼ˆå¦‚ï¼škubectl config set-context test --namespace=testï¼‰,ç„¶åä½¿ç”¨ kubectl config use-context test åˆ‡æ¢contextï¼Œä»è€Œé—´æ¥çš„è¾¾åˆ°åˆ‡æ¢namespaceçš„ç›®çš„ã€‚è¿™æ–¹æ³•å±å®æ˜¯å¤ªåˆ«æ‰­äº†ï¼Œå¼ºè¿«ç—‡æ‚£è€…éƒ½ä¸å–œæ¬¢ã€‚ æˆ–è€…ä½¿ç”¨kubectxå·¥å…·ï¼Œå…¶æœ¬è´¨æ˜¯åŠ¨æ€çš„ä¿®æ”¹contextå’Œnamespaceçš„ç»‘å®šå…³ç³»ã€‚ä½¿ç”¨å½¢å¦‚ï¼škubens test å³å¯åˆ‡æ¢ã€‚è¿™æ ·æ‰æ˜¯åˆ‡æ¢namespaceçš„æ­£ç¡®æ‰“å¼€æ–¹å¼ï¼Œä¼˜é›…å¤šäº†ã€‚  å‚è€ƒèµ„æ–™ï¼š Kuberneteså‘½åç©ºé—´
ä¸€æ¡å‘½ä»¤è§£å†³Kubernetesæ›´æ”¹é»˜è®¤çš„namespace
Kubernetes åˆ‡æ¢contextå’Œnamespace
k8sé›†ç¾¤namespaceå’Œcontextä½¿ç”¨
ahmetb / kubectx
æé«˜æ‚¨çš„kubectlç”Ÿäº§åŠ›ï¼ˆç¬¬ä¸‰éƒ¨åˆ†ï¼‰ï¼šé›†ç¾¤ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ä½¿ç”¨åˆ«åå‡å°‘è¾“å…¥å’Œæ’ä»¶æ‰©å±•</description>
    </item>
    
    <item>
      <title>åŒæ­¥é•œåƒåˆ°è‡ªå·±çš„ä»“åº“</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%90%8C%E6%AD%A5%E9%95%9C%E5%83%8F%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BB%93%E5%BA%93/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%90%8C%E6%AD%A5%E9%95%9C%E5%83%8F%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BB%93%E5%BA%93/</guid>
      <description>åŒæ­¥é•œåƒåˆ°è‡ªå·±çš„ä»“åº“ ç»å¸¸æœ‰ä¸€äº›å›½å¤–çš„é•œåƒä»“åº“ï¼Œåœ¨å›½å†…æ— æ³•æ‹‰å–ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å…ˆæ‰¾å°å›½å¤–çš„æœåŠ¡å™¨æ‹‰å–ä¸‹æ¥ï¼Œé‡æ–°æ‰“tagåæ¨é€åˆ°è‡ªå·±çš„é•œåƒä»“åº“ã€‚
1âƒ£ï¸ å…è´¹æœåŠ¡å™¨
https://labs.play-with-k8s.com/
2âƒ£ï¸ æ‹‰å–-æ‰“tag-æ¨é€
3âƒ£ï¸ éªŒè¯
å‚è€ƒé“¾æ¥ğŸ”— å¦‚ä½•æ‹‰å–k8s.grc.ioã€quay.ioçš„é•œåƒ</description>
    </item>
    
    <item>
      <title>åè¯è§£é‡Š</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80%E6%89%AB%E7%9B%B2/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80%E6%89%AB%E7%9B%B2/%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A/</guid>
      <description>Cluster
Cluster æ˜¯è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºçš„é›†åˆï¼ŒKubernetes åˆ©ç”¨è¿™äº›èµ„æºè¿è¡Œå„ç§åŸºäºå®¹å™¨çš„åº”ç”¨ã€‚
Master
Master æ˜¯ Cluster çš„å¤§è„‘ï¼Œå®ƒçš„ä¸»è¦èŒè´£æ˜¯è°ƒåº¦ï¼Œå³å†³å®šå°†åº”ç”¨æ”¾åœ¨å“ªé‡Œè¿è¡Œã€‚Master è¿è¡Œ Linux æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥æ˜¯ç‰©ç†æœºæˆ–è€…è™šæ‹Ÿæœºã€‚ä¸ºäº†å®ç°é«˜å¯ç”¨ï¼Œå¯ä»¥è¿è¡Œå¤šä¸ª Masterã€‚
Node
Node çš„èŒè´£æ˜¯è¿è¡Œå®¹å™¨åº”ç”¨ã€‚Node ç”± Master ç®¡ç†ï¼ŒNode è´Ÿè´£ç›‘æ§å¹¶æ±‡æŠ¥å®¹å™¨çš„çŠ¶æ€ï¼Œå¹¶æ ¹æ® Master çš„è¦æ±‚ç®¡ç†å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚Node è¿è¡Œåœ¨ Linux æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥æ˜¯ç‰©ç†æœºæˆ–è€…æ˜¯è™šæ‹Ÿæœºã€‚
Pod
Pod æ˜¯ Kubernetes çš„æœ€å°å·¥ä½œå•å…ƒã€‚æ¯ä¸ª Pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚Pod ä¸­çš„å®¹å™¨ä¼šä½œä¸ºä¸€ä¸ªæ•´ä½“è¢« Master è°ƒåº¦åˆ°ä¸€ä¸ª Node ä¸Šè¿è¡Œï¼Œä¸€ä¸ªPodé‡Œçš„æ‰€æœ‰å®¹å™¨å…±ç”¨ä¸€ä¸ªnamespaces
Controller
ç®¡ç†Podçš„å·¥å…·ï¼Œkubernetesé€šè¿‡å®ƒæ¥ç®¡ç†é›†ç¾¤ä¸­çš„Pod
Deployment
Deploymentæ§åˆ¶å™¨ä¸‹çš„Podéƒ½æœ‰ä¸ªå…±åŒç‰¹ç‚¹ï¼Œé‚£å°±æ˜¯æ¯ä¸ªPodé™¤äº†åç§°å’ŒIPåœ°å€ä¸åŒï¼Œå…¶ä½™å®Œå…¨ç›¸åŒã€‚éœ€è¦çš„æ—¶å€™ï¼ŒDeploymentå¯ä»¥é€šè¿‡Podæ¨¡æ¿åˆ›å»ºæ–°çš„Podï¼›ä¸éœ€è¦çš„æ—¶å€™ï¼ŒDeploymentå°±å¯ä»¥åˆ é™¤ä»»æ„ä¸€ä¸ªPodã€‚
ReplicaSet
ReplicaSet å®ç°äº† Pod çš„å¤šå‰¯æœ¬ç®¡ç†ã€‚ä½¿ç”¨ Deployment æ—¶ä¼šè‡ªåŠ¨åˆ›å»º ReplicaSetï¼Œä¹Ÿå°±æ˜¯è¯´ Deployment æ˜¯é€šè¿‡ ReplicaSet æ¥ç®¡ç† Pod çš„å¤šä¸ªå‰¯æœ¬ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦ç›´æ¥ä½¿ç”¨ ReplicaSetã€‚
DaemonSet
DaemonSetæ˜¯è¿™æ ·ä¸€ç§å¯¹è±¡ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰ï¼Œç”¨äºæ¯ä¸ª Node æœ€å¤šåªè¿è¡Œä¸€ä¸ª Pod å‰¯æœ¬çš„åœºæ™¯ï¼Œè¿™éå¸¸é€‚åˆä¸€äº›ç³»ç»Ÿå±‚é¢çš„åº”ç”¨ï¼Œä¾‹å¦‚æ—¥å¿—æ”¶é›†ã€èµ„æºç›‘æ§ç­‰ï¼Œè¿™ç±»åº”ç”¨éœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿è¡Œï¼Œä¸”ä¸éœ€è¦å¤ªå¤šå®ä¾‹ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¾‹å­å°±æ˜¯Kubernetesçš„kube-proxyã€‚
StatefuleSet
æä¾›å¦‚ä¸‹åŠŸèƒ½ï¼š
 ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨ï¼šå³Podé‡æ–°è°ƒåº¦åè¿˜æ˜¯èƒ½è®¿é—®åˆ°ç›¸åŒçš„æŒä¹…åŒ–æ•°æ®ï¼ŒåŸºäºPVCæ¥å®ç° ç¨³å®šçš„ç½‘ç»œæ ‡å¿—ï¼šå³Podé‡æ–°è°ƒåº¦åå…¶PodNameå’ŒHostNameä¸å˜ï¼ŒåŸºäºHeadless Serviceï¼ˆå³æ²¡æœ‰Cluster IPçš„Serviceï¼‰æ¥å®ç° æœ‰åºéƒ¨ç½²ï¼Œæœ‰åºæ‰©å±•ï¼šå³Podæ˜¯æœ‰é¡ºåºçš„ï¼Œåœ¨éƒ¨ç½²æˆ–è€…æ‰©å±•çš„æ—¶å€™è¦ä¾æ®å®šä¹‰çš„é¡ºåºä¾æ¬¡ä¾æ¬¡è¿›è¡Œï¼ˆå³ä»0åˆ°N-1ï¼Œåœ¨ä¸‹ä¸€ä¸ªPodè¿è¡Œä¹‹å‰æ‰€æœ‰ä¹‹å‰çš„Podå¿…é¡»éƒ½æ˜¯Runningå’ŒReadyçŠ¶æ€ï¼‰ï¼ŒåŸºäºinit containersæ¥å®ç° æœ‰åºæ”¶ç¼©ï¼Œæœ‰åºåˆ é™¤ï¼ˆå³ä»N-1åˆ°0ï¼‰  åƒZooKeeper, Nacosè¿™ç§åˆ†å¸ƒå¼ç³»ç»Ÿï¼ŒèŠ‚ç‚¹ä¹‹é—´æ˜¯è¦äº’ç›¸é€šä¿¡çš„ï¼Œå› æ­¤éœ€è¦ç½‘ç»œæ ‡å¿—ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹éœ€è¦å•ç‹¬å­˜åœ¨è‡ªå·±çš„çŠ¶æ€ï¼Œå› æ­¤éœ€è¦ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨ StatefulSet</description>
    </item>
    
    <item>
      <title>åœ¨namespaceä¹‹é—´å…±äº«secret</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%9C%A8namespace%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%ABsecret/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E5%9C%A8namespace%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%ABsecret/</guid>
      <description>åœ¨namespaceä¹‹é—´å…±äº«secret
æœ‰çš„æ—¶å€™åœ¨defaultç©ºé—´ä¸‹åˆ›å»ºäº†æ‹‰å–é•œåƒçš„secretï¼Œå½“éƒ¨ç½²k8sçš„èµ„æºåˆ°å…¶ä»–namespaceçš„æ—¶å€™ï¼Œå¦‚æœéƒ¨ç½²çš„çš„æ˜¯deploymentçš„ä¹‹ç±»çš„åŠ¿å¿…ä¼šè¦æ‹‰å–é•œåƒï¼Œè¿™ä¸ªæ—¶å€™å¿…ç„¶å¤±è´¥ï¼Œå› ä¸ºsecretåˆ›å»ºåœ¨defaultç©ºé—´ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†secretå¤åˆ¶ä¸€ä»½åˆ°éœ€è¦çš„namespaceä¸‹é¢ï¼š
kubectl get secret coding-regcred --namespace=default -oyaml | grep -v &amp;#39;^\s*namespace:\s&amp;#39; | kubectl apply --namespace=tkb -f - å‚è€ƒé“¾æ¥ï¼šKubernetes - sharing secret across namespaces</description>
    </item>
    
    <item>
      <title>å¤šPodå®ç°ç°åº¦</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/%E5%A4%9Apod%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%9F%BA%E7%A1%80/k8s%E5%9F%BA%E7%A1%80/k8s%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/%E5%A4%9Apod%E5%AE%9E%E7%8E%B0%E7%81%B0%E5%BA%A6/</guid>
      <description>å¦‚æœæ‚¨æƒ³ä½¿ç”¨ Deployment å°†æœ€æ–°çš„åº”ç”¨ç¨‹åºç‰ˆæœ¬å‘å¸ƒç»™ä¸€éƒ¨åˆ†ç”¨æˆ·ï¼ˆæˆ–æœåŠ¡å™¨ï¼‰ï¼Œæ‚¨å¯ä»¥ä¸ºæ¯ä¸ªç‰ˆæœ¬åˆ›å»ºä¸€ä¸ª Deploymentï¼Œæ­¤æ—¶ï¼Œåº”ç”¨ç¨‹åºçš„æ–°æ—§ä¸¤ä¸ªç‰ˆæœ¬éƒ½å¯ä»¥åŒæ—¶è·å¾—ç”Ÿäº§ä¸Šçš„æµé‡ã€‚
å®æ–½æ–¹æ¡ˆ   éƒ¨ç½²ç¬¬ä¸€ä¸ªç‰ˆæœ¬
ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ Deployment åŒ…å«äº† 3 ä¸ªPodå‰¯æœ¬ï¼ŒService é€šè¿‡ label selector app: nginx é€‰æ‹©å¯¹åº”çš„ Podï¼Œnginx çš„æ ‡ç­¾ä¸º 1.7.9
apiVersion: apps/v1 kind: Deployment metadata:  name: nginx-deployment  labels:  app: nginx spec:  replicas: 3  selector:  matchLabels:  app: nginx  template:  metadata:  labels:  app: nginx  spec:  containers:  - name: nginx  image: nginx:1.7.9 --- apiVersion: v1 kind: Service metadata:  name: nginx-service  labels:  app: nginx spec:  selector:  app: nginx  ports:  - name: nginx-port  protocol: TCP  port: 80  nodePort: 32600  targetPort: 80  type: NodePort   å‡è®¾æ­¤æ—¶æƒ³è¦å‘å¸ƒæ–°çš„ç‰ˆæœ¬ nginx 1.</description>
    </item>
    
    <item>
      <title>æš´éœ²grafanaç­‰å†…éƒ¨ç»„ä»¶æœåŠ¡</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/%E6%9A%B4%E9%9C%B2grafana%E7%AD%89%E5%86%85%E9%83%A8%E7%BB%84%E4%BB%B6%E6%9C%8D%E5%8A%A1/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%AE%9E%E6%88%98/%E6%9A%B4%E9%9C%B2grafana%E7%AD%89%E5%86%85%E9%83%A8%E7%BB%84%E4%BB%B6%E6%9C%8D%E5%8A%A1/</guid>
      <description>æš´éœ²grafanaç­‰å†…éƒ¨ç»„ä»¶æœåŠ¡
åœ¨å®‰è£…å®Œæˆistioåï¼Œé»˜è®¤çŠ¶æ€ä¸‹ï¼Œé›†ç¾¤å¤–ç”¨æˆ·ä¸èƒ½ç›´æ¥è®¿é—®istioé›†ç¾¤å†…çš„grafanaç­‰ç®¡ç†ã€ç›‘æ§æœåŠ¡ã€‚
æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å°†é›†ç¾¤å†…æœåŠ¡å¼€æ”¾å‡ºæ¥ã€‚ä¸€ç§æ˜¯ä½¿ç”¨port-forwardæ–¹å¼å°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°podç«¯å£ï¼Œå®ç°é›†ç¾¤å†…æœåŠ¡çš„è®¿é—®ï¼›å¦ä¸€ç§æ–¹å¼æ˜¯é‡‡ç”¨istio gatewayæ–¹å¼ï¼Œå°†é›†ç¾¤å†…æœåŠ¡æš´éœ²åˆ°å¤–ç½‘ã€‚
ç¬¬ä¸€ç§æ–¹å¼ï¼ˆä»¥æš´éœ²Prometheusä¸ºä¾‹ï¼Œå®˜æ–¹æ•™ç¨‹ä¹Ÿæ˜¯è¿™ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æå…¶åäººç±»ï¼Œæ¨èä½¿ç”¨ä¸‹é¢çš„ç¬¬äºŒç§æ–¹å¼ï¼‰ï¼š
kubectl -n Istio-system port-forward $(kubectl -n Istio-system get pod -l app=prometheus -o jsonpath=&amp;#39;{.items[0].metadata.name}&amp;#39;) 9090:9090 &amp;amp; ç¬¬äºŒç§æ–¹å¼éœ€è¦å°†é›†ç¾¤çš„é»˜è®¤ç½‘å…³æœåŠ¡ingressgatewayçš„ç½‘ç»œæ¨¡å¼è®¾ç½®ä¸ºLB/nodeportæ¨¡å¼ï¼Œä½œä¸ºä»£ç†å®ç°å¯¹å¤–æœåŠ¡ã€‚
1. è®¾ç½®ingress gatewayçš„å·¥ä½œæ¨¡å¼ å®‰è£…istioçš„æ—¶å€™é»˜è®¤å°±æ˜¯LBçš„
2. éªŒè¯ingress gatewayçš„ç½‘ç»œæ¨¡å¼ [root@k8s-master ~]# kubectl get svc -n Istio-system NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE grafana ClusterIP 10.101.122.19 &amp;lt;none&amp;gt; 3000/TCP 11h Istio-egressgateway ClusterIP 10.106.2.83 &amp;lt;none&amp;gt; 80/TCP,443/TCP,15443/TCP 11h Istio-ingressgateway LoadBalancer 10.110.238.41 &amp;lt;pending&amp;gt; 15020:31598/TCP,80:30299/TCP,443:31413/TCP,15029:30249/TCP,15030:32499/TCP,15031:31399/TCP,15032:32373/TCP,31400:30156/TCP,15443:30319/TCP 11h Istio-pilot ClusterIP 10.103.43.172 &amp;lt;none&amp;gt; 15010/TCP,15011/TCP,15012/TCP,8080/TCP,15014/TCP,443/TCP 11h istiod ClusterIP 10.105.251.21 &amp;lt;none&amp;gt; 15012/TCP,443/TCP 11h jaeger-agent ClusterIP None &amp;lt;none&amp;gt; 5775/UDP,6831/UDP,6832/UDP 11h jaeger-collector ClusterIP 10.</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼åŸç†</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E5%8E%9F%E7%90%86/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/istio/istio%E5%9F%BA%E7%A1%80/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E5%8E%9F%E7%90%86/</guid>
      <description>æœåŠ¡ç½‘æ ¼åŸç†</description>
    </item>
    
    <item>
      <title>æœ¬åœ°è¿æ¥k8sé›†ç¾¤</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E6%9C%AC%E5%9C%B0%E8%BF%9E%E6%8E%A5k8s%E9%9B%86%E7%BE%A4/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E6%9C%AC%E5%9C%B0%E8%BF%9E%E6%8E%A5k8s%E9%9B%86%E7%BE%A4/</guid>
      <description>æœ¬åœ°è¿æ¥k8sé›†ç¾¤ åœ¨æ—¥å¸¸å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šéœ€è¦åœ¨æœ¬åœ°å¼€å‘çš„ç¨‹åºéœ€è¦åœ¨k8sä¸­è°ƒè¯•çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼Œå†™äº†ä¸€ä¸ªoperatorã€‚
å¦‚æœæ­¤æ—¶ï¼Œæœ¬åœ°åˆæ²¡æœ‰å¯ä»¥ç›´æ¥å¯è¾¾çš„k8sé›†ç¾¤ï¼Œ
æ¯”å¦‚k8sæ˜¯åœ¨å…¬æœ‰äº‘çš„vpcç¯å¢ƒå†…ï¼Œå¤–é¢æ— æ³•ç›´æ¥è®¿é—®ã€‚æƒ³è¦æœ¬åœ°è¿æ¥è¿œç¨‹k8sé›†ç¾¤ï¼Œå¯ä»¥å‚è€ƒ æœ¬åœ°è¿æ¥è¿œç¨‹çš„å†…ç½‘k8sé›†ç¾¤
å†æ¯”å¦‚k8sé›†ç¾¤æ˜¯è‡ªå·±é€šè¿‡å¤šå°äº‘æœåŠ¡å™¨è‡ªè¡Œæ­å»ºçš„ï¼ŒmasterèŠ‚ç‚¹æœ‰è‡ªå·±çš„å…¬ç½‘ipã€‚æƒ³è¦æœ¬åœ°è¿æ¥è¿œç¨‹k8sé›†ç¾¤ï¼Œå¯ä»¥å‚è€ƒæœ¬æ–‡ã€‚
1âƒ£ï¸ é‡æ–°ç”Ÿæˆconfigæ–‡ä»¶ é»˜è®¤ä¸‹ï¼Œ~/.kube/config ç”Ÿæˆé…ç½®æ–‡ä»¶çš„æ—¶å€™åªåŒ…å«äº†k8sé›†ç¾¤ipå’Œè¿™ä¸ªèŠ‚ç‚¹çš„å±€åŸŸç½‘ipï¼Œæœ¬åœ°å¦‚æœæƒ³è¿œç¨‹æ“ä½œk8sçš„è¯ï¼Œå¿…å®šè¦é€šè¿‡å…¬ç½‘ipè¿æ¥åˆ°k8sé›†ç¾¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠèŠ‚ç‚¹ç»‘å®šçš„å…¬ç½‘ipä¹Ÿæ”¾åˆ°è¯ä¹¦é‡Œé¢å»ï¼Œå³æˆ‘ä»¬éœ€è¦é‡æ–°ç”Ÿæˆè¯ä¹¦ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œæœ¬åœ°ç›´æ¥è®¿é—®çš„è¯ï¼Œä¼šæŠ¥å¦‚ä¸‹æç¤ºï¼š
tony@192 ~ % kubectl get pod Unable to connect to the server: x509: certificate is valid for 10.96.0.1, 172.17.0.14, not 106.55.152.92 å…ˆå¤‡ä»½è¯ä¹¦ï¼š
[root@k8s-master .kube]# mkdir -p /etc/kubernetes/pki.bak [root@k8s-master .kube]# mv /etc/kubernetes/pki/apiserver.* /etc/kubernetes/pki.bak é‡æ–°ç”Ÿæˆè¯ä¹¦ï¼š
[root@k8s-master .kube]# kubeadm init phase certs all --apiserver-advertise-address=0.0.0.0 --apiserver-cert-extra-sans=10.96.0.1,172.17.0.14,xxx.xxx.xxx.xxx(å…¬ç½‘ip) I0627 15:10:39.069106 7777 version.go:252] remote version is much newer: v1.21.2; falling back to: stable-1.18 W0627 15:10:40.982380 7777 configset.go:202] WARNING: kubeadm cannot validate component configs for API groups [kubelet.</description>
    </item>
    
    <item>
      <title>éƒ¨ç½²sentinel-dashboard</title>
      <link>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E9%83%A8%E7%BD%B2sentinel-dashboard/</link>
      <pubDate>Fri, 27 Aug 2021 11:15:10 +0800</pubDate>
      
      <guid>https://xuzhijvn.github.io/en/zh-cn/posts/k8s/%E5%AE%9E%E6%88%98/%E9%83%A8%E7%BD%B2sentinel-dashboard/</guid>
      <description>éƒ¨ç½²sentinel-dashboard
1. æ„å»ºé•œåƒ FROMopenjdk:8-jdk-alpineVOLUME/tmpADD sentinel-dashboard-1.8.0.jar sentinel-dashboard.jarCMD java ${JAVA_OPTS} -jar sentinel-dashboard.jarEXPOSE87182. åˆ›å»ºheadless service apiVersion: v1 kind: Service metadata:  name: sentinel-headless  labels:  app: sentinel  annotations:  service.alpha.kubernetes.io/tolerate-unready-endpoints: &amp;#34;true&amp;#34; spec:  ports:  - port: 8718  name: server  targetPort: 8718  clusterIP: None  selector:  app: sentinel 3. åˆ›å»ºStatefulSet apiVersion: apps/v1 kind: StatefulSet metadata:  name: sentinel spec:  serviceName: sentinel  replicas: 1  template:  metadata:  labels:  app: sentinel  annotations:  pod.</description>
    </item>
    
  </channel>
</rss>
