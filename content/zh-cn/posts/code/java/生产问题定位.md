---
title: "ç”Ÿäº§é—®é¢˜å®šä½"
date: 2021-08-27T11:15:10+08:00
draft: false
reward: true
categories: [
"ç¼–ç¨‹æ€æƒ³"
]
tags : [
"Java"
]
series : [
"Manual"
]
images : [
"images/center.png"
]
---

[comment]: <> "# ç”Ÿäº§é—®é¢˜å®šä½"

1. æ’é™¤åº”ç”¨ä¹‹å¤–çš„å½±å“å› ç´ ï¼š `top`(cpu)ã€`free`(å†…å­˜)ã€`df`(ç£ç›˜)ã€`dstat`(ç½‘ç»œæµé‡)ã€`pstack`ã€`vmstat`ã€`st1race`(åº•å±‚ç³»ç»Ÿè°ƒç”¨)

2.  `top` å®šä½CPU æœ€é«˜çš„è¿›ç¨‹

3. `top -Hp pid` å®šä½ä½¿ç”¨ CPU æœ€é«˜çš„çº¿ç¨‹ï¼ˆæˆ–è€… `ps -mp pid -o THREAD,tid,time`ï¼‰

4.  `printf '0x%x' tid` çº¿ç¨‹ id è½¬åŒ– 16 è¿›åˆ¶

5. `jstack pid | grep tid` æ‰¾åˆ°çº¿ç¨‹å †æ ˆ

   5.1 gcçº¿ç¨‹ï¼ˆå¦‚ä¸‹æ˜¯æŸ¥çœ‹gcæƒ…å†µçš„å‡ ç§æ–¹å¼ï¼‰
   
   ğŸ‘‰ğŸ¿ æŸ¥çœ‹gc æ—¥å¿—
   
   ğŸ‘‰ğŸ¿ `jstat -gcutil è¿›ç¨‹å· ç»Ÿè®¡é—´éš”æ¯«ç§’ ç»Ÿè®¡æ¬¡æ•°ï¼ˆç¼ºçœä»£è¡¨ä¸€è‡´ç»Ÿè®¡`
   
   ğŸ‘‰ğŸ¿ å¦‚æœæ‰€åœ¨å…¬å¸æœ‰å¯¹åº”ç”¨è¿›è¡Œç›‘æ§çš„ç»„ä»¶å½“ç„¶æ›´æ–¹ä¾¿ï¼ˆæ¯”å¦‚Prometheus + Grafanaï¼‰
   
   5.2 ä¸šåŠ¡çº¿ç¨‹
   
   ğŸ‘‰ğŸ¿ å…³æ³¨çº¿ç¨‹å †æ ˆçš„`lock`å­—æ®µ
   
   ğŸ‘‰ğŸ¿ `jstack -l pid | grep BLOCKED` æŸ¥çœ‹é˜»å¡æ€çº¿ç¨‹å †æ ˆ

