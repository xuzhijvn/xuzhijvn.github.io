+++
title = "Note"
description = ""
date = 2021-10-03T11:20:44+08:00
featured = false
draft = true
comment = true
toc = true
reward = true
categories = [
  ""
]
tags = [
  ""
]
series = []
images = []
+++

<!--more-->

åˆ›æ–°å®éªŒå®¤ï¼ŒåŠç ”ç©¶æ€§è´¨çš„ï¼Œç ”ç©¶æˆæœè½¬åŒ–çš„å›¢é˜Ÿã€‚æˆ‘è´Ÿè´£é¡¹ç›®å¼€å‘ï¼ŒåŒ…æ‹¬åŒºå—é“¾å¹³å°ï¼Œåˆ†å¸ƒå¼å…±è¯†ç®—æ³•ä¼˜åŒ–ï¼Œæ™ºèƒ½ç›‘æ§ç³»ç»Ÿï¼›å…ˆè¿›æŠ€æœ¯é¢„ç ”ï¼ŒåŒ…æ‹¬æ­å»ºå·ç§¯ç¥ç»ç½‘ç»œç”¨äºå›¾åƒè´¨é‡åˆ†æã€ä¿¡ç”¨å¡é£é™©è¯†åˆ«ã€‚

é£æ§äº‹ä¸šéƒ¨ï¼Œä¸šåŠ¡å¼€å‘ï¼Œç»„å†…åŸºç¡€è®¾æ–½ã€‚

### ä¸ºä»€ä¹ˆè·³æ§½ï¼Ÿ

**é“¶è¡Œï¼š**

ä¼ä¸šæ°›å›´ï¼šå—ä¸äº†å®˜æœ¬ä½é‚£ä¸€å¥—ï¼›å—ä¸äº†ä»Šå¤©å¼€å±•æ‰¹è¯„ä¸è‡ªæˆ‘æ‰¹æ°‘ä¸»ç”Ÿæ´»ä¼šï¼Œæ˜å¤©å¼€å±•è¿™è®²è¯é‚£ç²¾ç¥ä¸“é¢˜å­¦ä¹ ã€‚

å…¬å¸å¯¹å›¢é˜Ÿå®šä½ä¸æ˜ç¡®ï¼Œèº«å¿ƒä¿±ç–²ï¼šåˆæœ‰ç‰ˆæœ¬ä»»åŠ¡ï¼Œåˆè¦å†™å„ç§ææ–™ä¸“åˆ©ã€æŠ€æœ¯æ–¹æ¡ˆè¯„å®¡ã€è”å¸­æ–¹æ¡ˆè¯„å®¡ã€å‰ç»æ€§ç ”ç©¶æŠ¥å‘Šã€è¡Œä¸šè¶‹åŠ¿åˆ†ææŠ¥å‘Š

**è´§æ‹‰æ‹‰ï¼š**

å›¢é˜Ÿç¼ºä¹æŠ€æœ¯æ°›å›´ï¼šå±…ç„¶æ²¡æœ‰å®šæœŸçš„æŠ€æœ¯åˆ†äº«ã€æ·±åº¦ä¹Ÿä¸å¤Ÿï¼Œæ‰¾è¿ç»´è¦ä¸­é—´ä»¶è¿™æ²¡æœ‰é‚£ä¸æ”¯æŒçš„

å²—ä½ç¼ºä¹æŒ‘æˆ˜ï¼šé©¾è½»å°±ç†Ÿï¼Œè€Œä¸”ç¼ºä¹æˆé•¿ç©ºé—´ï¼Œè¿™ä½¿å¾—æˆ‘å¾ˆç„¦è™‘ã€‚



### ç½‘å…³æ€§èƒ½æŒ‡æ ‡

**æµé‡ç½‘å…³**ï¼šé«˜æ€§èƒ½ï¼Œä¸å…·ä½“çš„ä¸šåŠ¡è€¦åˆå°‘ï¼Œä¸“æ³¨è½¬å‘ï¼Œä¸ç”¨å¼•å…¥ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨ç»´æŠ¤luaè„šæœ¬ï¼Œä¸è¦ä¸“é—¨çš„luaå›¢é˜Ÿ

**ä¸šåŠ¡ç½‘å…³**ï¼šæ€§èƒ½è¾ƒé«˜ï¼ˆæ²¡æœ‰æŒ‡æ•°çº§åˆ«çš„å·®è·ï¼‰ï¼Œä¸ä¸šåŠ¡ã€æŠ€æœ¯æ ˆç›¸å…³ï¼Œæ¯”å¦‚è¦é€šè¿‡JaråŒ…å’Œnacosã€sentialé…åˆä½¿ç”¨

Mockæ¥å£æ¨¡æ‹Ÿ20msæ—¶å»¶ï¼ŒæŠ¥æ–‡å¤§å°çº¦2Kã€‚

4æ ¸8G

| åˆ†ç±»     | äº§å“                          | 600å¹¶å‘ QPS | 600å¹¶å‘ 90% Latency(ms) | 1000å¹¶å‘ QPS | 1000å¹¶å‘ 90% Latency(ms) |
| -------- | ----------------------------- | ----------- | ----------------------- | ------------ | ------------------------ |
| åç«¯æœåŠ¡ | ç›´æ¥è®¿é—®åç«¯æœåŠ¡              | 23540       | 32.19                   | 27325        | 52.09                    |
| æµé‡ç½‘å…³ | kong v2.4.1                   | 15662       | 50.87                   | 17152        | 84.3                     |
| åº”ç”¨ç½‘å…³ | fizz-gateway-community v2.0.0 | 12206       | 65.76                   | 12766        | 100.34                   |
| åº”ç”¨ç½‘å…³ | spring-cloud-gateway v2.2.9   | 11323       | 68.57                   | 10472        | 127.59                   |
| åº”ç”¨ç½‘å…³ | shenyu v2.3.0                 | 9284        | 92.98                   | 9939         | 148.61                   |

### hashmapæ‰©å®¹æœºåˆ¶

å½“mapä¸­åŒ…å«çš„Entryçš„æ•°é‡å¤§äºç­‰äºthreshold = loadFactor * capacityçš„æ—¶å€™ï¼Œä¸”æ–°å»ºçš„Entryåˆšå¥½è½åœ¨ä¸€ä¸ªéç©ºçš„æ¡¶ä¸Šï¼Œæ­¤åˆ»è§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œå°†å…¶å®¹é‡æ‰©å¤§ä¸º2å€ã€‚è°ƒç”¨resizeæ‰©å®¹ã€‚

### ConcurrentHashMap

**JDK7**

`æ•°æ®ç»“æ„`ï¼šReentrantLock + Segment + HashEntry

mapä¸€ä¸ªSegmentæ•°ç»„ï¼ŒSegmentåˆæ˜¯ä¸€ä¸ªHashEntryæ•°ç»„ï¼ŒHashEntryæœ‰nextæŒ‡é’ˆï¼Œæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„

`å…ƒç´ æŸ¥è¯¢`ï¼šäºŒæ¬¡hash + é“¾è¡¨éå†ï¼Œç¬¬ä¸€æ¬¡Hashå®šä½åˆ°Segment ï¼Œç¬¬äºŒæ¬¡Hashå®šä½åˆ°å…ƒç´¢æ‰€åœ¨çš„é“¾è¡¨çš„å¤´éƒ¨

`é”`ï¼šSegmentç»§æ‰¿äº†ReentrantLockï¼Œé”å®šæ“ä½œçš„Segmentï¼Œå…¶ä»–çš„Segmentä¸å—å½±å“ï¼Œå¹¶å‘åº¦ä¸ºSegmentä¸ªæ•°ï¼Œå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æŒ‡å®šï¼Œæ•°ç»„æ‰©å®¹ä¸ä¼šå½±æ™Œå…¶ä»–Segment

**JDK8**

`æ•°æ®ç»“æ„`ï¼šsynchronized + CAS + Node + çº¢é»‘æ ‘

> å…¶å® Node å’Œ HashEntry çš„å†…å®¹ä¸€æ ·

`å…ƒç´ æŸ¥è¯¢`ï¼šä¸€æ¬¡hash + éå†çº¢é»‘æ ‘ï¼ˆå…ƒç´ ä¸ªæ•°å°äº8çš„æ—¶å€™è¿˜æ˜¯é“¾è¡¨ï¼‰

`é”`ï¼šé”é“¾è¡¨çš„headèŠ‚ç‚¹ï¼Œä¸å½±å“å…¶ä»–å…ƒç´ çš„è¯»å†™ï¼Œé”ç²’åº¦æ›´ç»†ï¼Œæ•ˆç‡æ›´é«˜ï¼Œæ‰©å®¹æ—¶é˜»èµ›æ‰€æœ‰çš„è¯»å†™æ“ä½œã€å¹¶å‘æ‰©å®¹



**ä¸‹é¢ç®€å•ä»‹ç»ä¸‹ä¸»è¦çš„å‡ ä¸ªæ–¹æ³•çš„ä¸€äº›åŒºåˆ«ï¼š**

|        | JDK1.7                                                       | JDK1.8                                                       |
| ------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| put    | éœ€è¦å®šä½ 2 æ¬¡ ï¼ˆsegments[i]ï¼Œsegmentä¸­çš„table[i]ï¼‰ æ²¡è·å–åˆ° segmenté”çš„çº¿ç¨‹ï¼Œæ²¡æœ‰æƒåŠ›è¿›è¡Œputæ“ä½œï¼Œä¸æ˜¯åƒHashTableä¸€æ ·å»æŒ‚èµ·ç­‰å¾…ï¼Œè€Œæ˜¯ä¼šå»åšä¸€ä¸‹putæ“ä½œå‰çš„å‡†å¤‡ï¼š  table[i]çš„ä½ç½®(ä½ çš„å€¼è¦putåˆ°å“ªä¸ªæ¡¶ä¸­) é€šè¿‡é¦–èŠ‚ç‚¹firstéå†é“¾è¡¨æ‰¾æœ‰æ²¡æœ‰ç›¸åŒkey åœ¨è¿›è¡Œ1ã€2çš„æœŸé—´è¿˜ä¸æ–­è‡ªæ—‹è·å–é”ï¼Œè¶…è¿‡ `64æ¬¡` çº¿ç¨‹æŒ‚èµ·ï¼ï¼ˆå•å¤„ç†å™¨è‡ªæ—‹1æ¬¡ï¼‰ | å…ˆæ‹¿åˆ°æ ¹æ® rehashå€¼å®šä½ï¼Œæ‹¿åˆ°table[i]çš„ é¦–èŠ‚ç‚¹firstï¼Œç„¶åï¼šå¦‚æœä¸º `null` ï¼Œé€šè¿‡ `CAS` çš„æ–¹å¼æŠŠ value putè¿›å» å¦‚æœ `énull` ï¼Œå¹¶ä¸” `first.hash == -1` ï¼Œè¯´æ˜å…¶ä»–çº¿ç¨‹åœ¨æ‰©å®¹ï¼Œå‚ä¸ä¸€èµ·æ‰©å®¹ å¦‚æœ `énull` ï¼Œå¹¶ä¸” `first.hash != -1` ï¼ŒSynchronizedé”ä½ firstèŠ‚ç‚¹ï¼Œåˆ¤æ–­æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œéå†æ’å…¥ã€‚ |
| get    |                                                              |                                                              |
| resize |                                                              |                                                              |
| size   |                                                              |                                                              |



#### 1. put() æ–¹æ³•

**JDK1.7ä¸­çš„å®ç°ï¼š**

- éœ€è¦å®šä½ 2 æ¬¡ ï¼ˆsegments[i]ï¼Œsegmentä¸­çš„table[i]ï¼‰
- æ²¡è·å–åˆ° segmenté”çš„çº¿ç¨‹ï¼Œæ²¡æœ‰æƒåŠ›è¿›è¡Œputæ“ä½œï¼Œä¸æ˜¯åƒHashTableä¸€æ ·å»æŒ‚èµ·ç­‰å¾…ï¼Œè€Œæ˜¯ä¼šå»åšä¸€ä¸‹putæ“ä½œå‰çš„å‡†å¤‡ï¼š
  1. table[i]çš„ä½ç½®(ä½ çš„å€¼è¦putåˆ°å“ªä¸ªæ¡¶ä¸­)
  2. é€šè¿‡é¦–èŠ‚ç‚¹firstéå†é“¾è¡¨æ‰¾æœ‰æ²¡æœ‰ç›¸åŒkey
  3. åœ¨è¿›è¡Œ1ã€2çš„æœŸé—´è¿˜ä¸æ–­è‡ªæ—‹è·å–é”ï¼Œè¶…è¿‡ `64æ¬¡` çº¿ç¨‹æŒ‚èµ·ï¼ï¼ˆå•å¤„ç†å™¨è‡ªæ—‹1æ¬¡ï¼‰

**JDK1.8ä¸­çš„å®ç°ï¼š**

- å…ˆæ‹¿åˆ°æ ¹æ® rehashå€¼å®šä½ï¼Œæ‹¿åˆ°table[i]çš„ é¦–èŠ‚ç‚¹firstï¼Œç„¶åï¼š
  1. å¦‚æœä¸º `null` ï¼Œé€šè¿‡ `CAS` çš„æ–¹å¼æŠŠ value putè¿›å»
  2. å¦‚æœ `énull` ï¼Œå¹¶ä¸” `first.hash == -1` ï¼Œè¯´æ˜å…¶ä»–çº¿ç¨‹åœ¨æ‰©å®¹ï¼Œå‚ä¸ä¸€èµ·æ‰©å®¹
  3. å¦‚æœ `énull` ï¼Œå¹¶ä¸” `first.hash != -1` ï¼ŒSynchronizedé”ä½ firstèŠ‚ç‚¹ï¼Œåˆ¤æ–­æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œéå†æ’å…¥ã€‚

#### 2. get() æ–¹æ³•

**JDK1.7ä¸­çš„å®ç°ï¼š**

- ç”±äºå˜é‡ `value` æ˜¯ç”± `volatile` ä¿®é¥°çš„ï¼Œjavaå†…å­˜æ¨¡å‹ä¸­çš„ `happen before` è§„åˆ™ä¿è¯äº† å¯¹äº volatile ä¿®é¥°çš„å˜é‡å§‹ç»ˆæ˜¯ `å†™æ“ä½œ` å…ˆäº `è¯»æ“ä½œ` çš„ï¼Œå¹¶ä¸”è¿˜æœ‰ volatile çš„ `å†…å­˜å¯è§æ€§` ä¿è¯ä¿®æ”¹å®Œçš„æ•°æ®å¯ä»¥é©¬ä¸Šæ›´æ–°åˆ°ä¸»å­˜ä¸­ï¼Œæ‰€ä»¥èƒ½ä¿è¯åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œè¯»å‡ºæ¥çš„æ•°æ®æ˜¯æœ€æ–°çš„æ•°æ®ã€‚
- å¦‚æœget()åˆ°çš„æ˜¯nullå€¼æ‰å»åŠ é”ã€‚

**JDK1.8ä¸­çš„å®ç°ï¼š**

- å’Œ JDK1.7ç±»ä¼¼

#### 3. resize() æ–¹æ³•

**JDK1.7ä¸­çš„å®ç°ï¼š**

- è·ŸHashMapçš„ resize() æ²¡å¤ªå¤§åŒºåˆ«ï¼Œéƒ½æ˜¯åœ¨ put() å…ƒç´ æ—¶å»åšçš„æ‰©å®¹ï¼Œæ‰€ä»¥åœ¨1.7ä¸­çš„å®ç°æ˜¯è·å¾—äº†é”ä¹‹åï¼Œåœ¨å•çº¿ç¨‹ä¸­å»åšæ‰©
  1. `newä¸ª2å€æ•°ç»„`
  2. `éå†oldæ•°ç»„èŠ‚ç‚¹æ¬å»æ–°æ•°ç»„`

**JDK1.8ä¸­çš„å®ç°ï¼š**

- jdk1.8çš„æ‰©å®¹æ”¯æŒå¹¶å‘è¿ç§»èŠ‚ç‚¹ï¼Œä»oldæ•°ç»„çš„å°¾éƒ¨å¼€å§‹ï¼Œå¦‚æœè¯¥æ¡¶è¢«å…¶ä»–çº¿ç¨‹å¤„ç†è¿‡äº†ï¼Œå°±åˆ›å»ºä¸€ä¸ª ForwardingNode æ”¾åˆ°è¯¥æ¡¶çš„é¦–èŠ‚ç‚¹ï¼Œhashå€¼ä¸º-1ï¼Œå…¶ä»–çº¿ç¨‹åˆ¤æ–­hashå€¼ä¸º-1åå°±çŸ¥é“è¯¥æ¡¶è¢«å¤„ç†è¿‡äº†ã€‚

#### 4. è®¡ç®—size

**JDK1.7ä¸­çš„å®ç°ï¼š**

- å…ˆé‡‡ç”¨ä¸åŠ é”çš„æ–¹å¼ï¼Œè®¡ç®—ä¸¤æ¬¡ï¼Œå¦‚æœä¸¤æ¬¡ç»“æœä¸€æ ·ï¼Œè¯´æ˜æ˜¯æ­£ç¡®çš„ï¼Œè¿”å›ã€‚
- å¦‚æœä¸¤æ¬¡ç»“æœä¸ä¸€æ ·ï¼Œåˆ™æŠŠæ‰€æœ‰ segment é”ä½ï¼Œé‡æ–°è®¡ç®—æ‰€æœ‰ segmentçš„ `Count` çš„å’Œ

**JDK1.8ä¸­çš„å®ç°ï¼š**

ç”±äºæ²¡æœ‰segmentçš„æ¦‚å¿µï¼Œæ‰€ä»¥åªéœ€è¦ç”¨ä¸€ä¸ª `baseCount` å˜é‡æ¥è®°å½•ConcurrentHashMap å½“å‰ `èŠ‚ç‚¹çš„ä¸ªæ•°`ã€‚

- å…ˆå°è¯•é€šè¿‡CAS ä¿®æ”¹ `baseCount`
- å¦‚æœå¤šçº¿ç¨‹ç«äº‰æ¿€çƒˆï¼ŒæŸäº›çº¿ç¨‹CASå¤±è´¥ï¼Œé‚£å°±CASå°è¯•å°† `CELLSBUSY` ç½®1ï¼ŒæˆåŠŸåˆ™å¯ä»¥æŠŠ `baseCountå˜åŒ–çš„æ¬¡æ•°` æš‚å­˜åˆ°ä¸€ä¸ªæ•°ç»„ `counterCells` é‡Œï¼Œåç»­æ•°ç»„ `counterCells` çš„å€¼ä¼šåŠ åˆ° `baseCount` ä¸­ã€‚
- å¦‚æœ `CELLSBUSY` ç½®1å¤±è´¥åˆä¼šåå¤è¿›è¡ŒCAS`baseCount` å’Œ CAS`counterCells`æ•°ç»„



### å°è±¡æ·±åˆ»çš„ç»å†

ä¸€æ¬¡ç¼“å­˜ä¼˜åŒ–ç»å†

Redisä½¿ç”¨é¢‘ç‡å¾ˆé«˜ï¼Œæµé‡é«˜å³°æœŸåƒå…†ç½‘å¡è·‘æ»¡ï¼Œå¯¼è‡´æ•°æ®è¯»å–éå¸¸æ…¢ã€‚

**å…·ä½“æ¥è¯´**ï¼šå‡è®¾åº”ç”¨æ¥å£çš„æ€»è®¿é—®æ¬¡æ•°æ˜¯1000ä¸‡ï¼Œæ€»ç¼“å­˜æ•°æ®é‡å¤§å°50KBï¼Œä¸€å¤©è¦æ‰¿å— 500G çš„æ•°æ®æµï¼Œå¹³å‡æ¯ç§’é’Ÿæ˜¯ 5.78M çš„æ•°æ®ï¼Œé«˜å³°æœŸæŒ‰50å€ä¼°ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´é«˜å³°æœŸ Redis æœåŠ¡æ¯ç§’è¦ä¼ è¾“è¶…è¿‡ 250 MBçš„æ•°æ®ï¼Œè€Œåƒå…†ç½‘å¡çš„å¸¦å®½åªåœ¨120å¤šMBã€‚

æ­¤æ—¶ï¼Œç«‹é©¬èƒ½æƒ³åˆ°çš„è§£å†³åŠæ³•æ˜¯ï¼š1. å‡çº§åˆ°ä¸‡å…†ç½‘å¡ã€‚2. ä½¿ç”¨redis clusteræ¨¡å¼ï¼Œå¹¶å¢åŠ redisèŠ‚ç‚¹æ•°é‡ï¼Œå°†æµé‡åˆ†æ‘Šå¤šå¤šå°æœºå™¨ä¸Š

ä½†æ˜¯ï¼Œäº‘æœåŠ¡å™¨å‡çº§ä¸‡å…†ç½‘å¡å›°éš¾ã€‚å¢åŠ èŠ‚ç‚¹ä½¿å¾—æˆæœ¬æ”€å‡ï¼Œå¹¶ä¸”æ­¤æ—¶æ•°æ®é‡å¹¶ä¸å¤§ï¼ŒæœåŠ¡å™¨è´Ÿè½½å¹¶ä¸é«˜ï¼Œä»…ä»…æ˜¯redisæœåŠ¡å™¨æ•°æ®ååé‡å¤§ã€‚

å¦è¾Ÿè¹Šå¾„ï¼šå…ˆè®¿é—®æœ¬åœ°å†…å­˜ï¼Œå†è®¿é—®redisï¼Œé™ä½redisçš„è®¿é—®é¢‘ç‡ï¼ˆèŠ‚ç‚¹é—´æ•°æ®åŒæ­¥çš„æ–¹æ¡ˆ â€”â€” Redis Pub/Sub ,  JGroups , MQï¼‰ã€‚

å…¶ä»–ç±»ä¼¼æ–¹æ¡ˆçš„ç¼ºé™·ï¼š**Ehcacheé›†ç¾¤æ¨¡å¼** åœ¨åº”ç”¨èŠ‚ç‚¹ä¹‹é—´ä¼ é€’å®Œæ•´ç¼“å­˜æ•°æ®ï¼Œè¿™æ ·å²‚ä¸æ˜¯ä¼šæŠŠåº”ç”¨æœåŠ¡å™¨çš„å¸¦å®½è·‘æ»¡ï¼Ÿè€Œï¼Œ

J2Cacheçš„é—®é¢˜ï¼šå¦‚æœåº”ç”¨å‘ç”Ÿé‡å¯ï¼Œæœ¬åœ°ç¼“å­˜è¶…æ—¶æ—¶é—´ä¸¢å¤±ã€‚

æœªæ¥æ–¹å‘ï¼šå°è£…æˆä¸€ä¸ªè¿›ç¨‹ï¼ŒæœåŠ¡å™¨å®‰è£…åï¼Œå…¶ä»–å¼€å‘è¯­è¨€çš„åº”ç”¨å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨ã€‚



### go channel

https://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-channel/

### nettyé¢è¯•

### springå•ä¾‹vså¤šä¾‹

Spring Beanæœ‰äº”ç§ä½œç”¨åŸŸï¼š

`singleton` ,  `prototype`,  `request` , `session` ,  `global session`

é»˜è®¤æ˜¯å•ä¾‹ï¼Œå¯ä»¥é€šè¿‡xmlé…ç½®beanå¤šä¾‹ï¼Œæ›´æ–¹ä¾¿çš„æ˜¯ç”¨@Scope("prototype")æ³¨è§£ã€‚

Controller, Service, DAOé»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ã€‚

å•ä¾‹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸è¦åœ¨ç±»ä¸­ä½¿ç”¨çŠ¶æ€å¯å˜çš„æˆå‘˜å˜é‡ã€‚

### @Autowired å’Œ @ResourseåŒºåˆ«

ä¸¤è€…éƒ½å¯ä»¥å†™åœ¨å­—æ®µå’Œsetteræ–¹æ³•ä¸Š

@Autowiredæ˜¯Springä¸­å®šä¹‰æ³¨è§£ï¼Œ@Resourseæ˜¯JREå®šä¹‰çš„æ³¨è§£

@Autowiredé»˜è®¤æŒ‰byTypeè£…é…ï¼Œéœ€è¦æŒ‰byNameæ¥è£…é…ï¼Œå¯ä»¥ç»“åˆ@Qualifieræ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œ@Resourseé»˜è®¤æŒ‰byNameè£…é…ï¼Œå®ƒæœ‰å¯ä»¥é…ç½®çš„å±æ€§ nameå’Œtype

```java
public class TestServiceImpl {
    @Autowired
    @Qualifier("userDao")
    private UserDao userDao; 
}
```



### tcpä¸‰æ¡å››åˆ† + SpringMVC æ‰“å¼€ç½‘ç«™çœ‹



### Springè®¾è®¡æ¨¡å¼

é€‚é…å™¨ + å·¥å‚ + ä»£ç† + å•ä¾‹

### æ•°æ®åº“æ·±åˆ†é¡µä¼˜åŒ–

æˆå› ï¼šå¤§é‡å›è¡¨ ğŸ‘‰ğŸ¿ å¤§é‡éšæœºIO

> å³ä½¿å‰10000ä¸ªä¼šæ‰”æ‰ï¼Œmysqlä¹Ÿä¼šé€šè¿‡äºŒçº§ç´¢å¼•ä¸Šçš„ä¸»é”®idï¼Œå»èšç°‡ç´¢å¼•ä¸ŠæŸ¥ä¸€éæ•°æ®ï¼Œè¿™å¯æ˜¯10000æ¬¡éšæœºioï¼Œè‡ªç„¶æ…¢æˆå“ˆå£«å¥‡ã€‚ è¿™é‡Œå¯èƒ½ä¼šæå‡ºç–‘é—®ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§è¡Œä¸ºï¼Œè¿™æ˜¯mysqlä¼˜åŒ–å™¨çš„å‘ï¼Œè‡³ä»Šä¹Ÿæ²¡è§£å†³ã€‚

**å­æŸ¥è¯¢ä¼˜åŒ–ï¼š** å¦‚ä¸‹åªæœ‰10æ¬¡å›è¡¨

```sql
select xxx,xxx from in (select id from table where second_index = xxx limit 10 offset 10000) 
```

**ä¹¦ç­¾è®°å½•ï¼š**é€šè¿‡ä¸»é”®ç´¢å¼•ä¼˜åŒ–

```sql
SELECT * FROM cps_user_order_detail d WHERE d.id > #{maxId} AND d.order_time>'2020-8-5 00:00:00' ORDER BY d.order_time desc LIMIT 6;
```

idè¦æ˜¯é€’å¢ï¼Œä¸èƒ½è·³é¡µ

**ES + scroll + search_after**

æ»šåŠ¨ç¿»é¡µ

### RabbitMQäº¤æ¢æœºç±»å‹

<img src="https://pic2.zhimg.com/80/v2-a8594e4f7fec1495e692bdd1dc152d19_1440w.jpg" alt="img" style="zoom:67%;" />

Exchange çš„ä¸‰ç§ä¸»è¦ç±»å‹ï¼š`Fanout`ã€`Direct` å’Œ `Topic`

Fanout Exchange ä¼šå¿½ç•¥ RoutingKey çš„è®¾ç½®ï¼Œç›´æ¥å°† Message å¹¿æ’­åˆ°æ‰€æœ‰ç»‘å®šçš„ Queue ä¸­ï¼Œ`å¹¿æ’­`

Direct Exchange æ˜¯ RabbitMQ é»˜è®¤çš„ Exchangeï¼Œå¯¹ RoutingKey æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œ`å•æ’­`

Topic Exchange æ”¯æŒå¯¹ RoutingKey æ¨¡ç³ŠåŒ¹é…ï¼Œ`å¤šæ’­`

### Javaé€šè¿‡Executorsæä¾›å››ç§çº¿ç¨‹æ± 

åˆ†åˆ«ä¸ºï¼š

- **newCachedThreadPool**åˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœ**çº¿ç¨‹æ± é•¿åº¦**è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯ç”¨çº¿ç¨‹ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚
- **newFixedThreadPool**åˆ›å»ºä¸€ä¸ª***\*å®šé•¿çº¿ç¨‹æ± \****ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚
- ***\*newScheduledThreadPool\****åˆ›å»ºä¸€ä¸ª**å®šé•¿çº¿ç¨‹æ± **ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚
- ***\*newSingleThreadExecutor\**** åˆ›å»ºä¸€ä¸ª**å•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± **ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚



### å¸¸ç”¨HttpçŠ¶æ€ç 



301 Moved Permanently ï¼šæ°¸ä¹…é‡å®šå‘ï¼ˆä¼˜å…ˆä½¿ç”¨301ï¼‰

302 Foundï¼ˆä¸´æ—¶é‡å®šå‘ï¼‰



401 Unauthorized

403 Forbiddenï¼šèµ„æºä¸å¯ç”¨ï¼Œé˜²ç›—é“¾

429 Too Many Requests



500 Internal Server Error

502 Bad Gateway

503 Service Unavailable

504 Gateway Timeout

### 3ä¸ªé—®é¢˜ï¼ŒæŠ€æœ¯æ ˆæ˜¯ä»€ä¹ˆï¼Ÿ+ å›¢é˜Ÿè´Ÿè´£çš„å·¥ä½œå†…å®¹æ˜¯ï¼Ÿ+  ä»Šå¤©çš„è¡¨ç°åšæ€ä¹ˆæ ·çš„è¯„ä»·ï¼Ÿ
