---
title: "cacheå’Œbuffer"
date: 2021-08-27T11:15:10+08:00
draft: false
reward: true
categories: [
"è®¡ç®—æœºç§‘å­¦"
]
tags : [
"CS",
"System"
]
series : [
"Manual"
]
images : [

]
---

[comment]: <> "# cacheå’Œbuffer"

é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ `free -m` æŸ¥çœ‹ç³»ç»Ÿå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼š

<img src="https://cdn.tkaid.com/img/20200502221926518.png" alt="è€ç‰ˆæœ¬linuxå†…æ ¸" style="zoom:50%;" />

å¯ä»¥çœ‹å‡ºï¼Œç³»ç»Ÿå†…å­˜ä¸º 16Gï¼ŒSwap å†…å­˜ 16Gï¼Œmem free è™½ç„¶æ˜¾ç¤ºä¸º 1118ï¼Œå› ç¼“å­˜çš„å­˜åœ¨ï¼Œä¸èƒ½è®¤ä¸ºç³»ç»Ÿç›®å‰å†…å‰©ä¸‹è¿™ä¹ˆå¤šå†…å­˜ã€‚è€Œåº”è¯¥æŠŠ buffersã€cached çš„ä¹Ÿç®—ä¸Šï¼Œå³ free+cached+buffers=1118+7110+430ï¼8658ï¼Œæ€»å†…å­˜å†å‡å» 8658ï¼7314ï¼Œä¸ buffers/cache è¡Œä¸­å¯¹åº” free åˆ—çš„ 7312 å’Œ 8659 åŸºæœ¬ä¸€è‡´ã€‚

> è¿™é‡Œé¡ºä¾¿ä»‹ç»ä¸€ä¸‹Swapï¼Œäº†è§£Swapæ›´å¤šè¯¦æƒ…è¯·ç§»æ­¥ ğŸ‘‰ [Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ](https://www.cnblogs.com/kerrycode/p/5246383.html)

> Linuxå†…æ ¸ä¸ºäº†æé«˜è¯»å†™æ•ˆç‡ä¸é€Ÿåº¦ï¼Œä¼šå°†æ–‡ä»¶åœ¨å†…å­˜ä¸­è¿›è¡Œç¼“å­˜ï¼Œè¿™éƒ¨åˆ†å†…å­˜å°±æ˜¯Cache Memory(ç¼“å­˜å†…å­˜)ã€‚å³ä½¿ä½ çš„ç¨‹åºè¿è¡Œç»“æŸåï¼ŒCache Memoryä¹Ÿä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚è¿™å°±ä¼šå¯¼è‡´ä½ åœ¨Linuxç³»ç»Ÿä¸­ç¨‹åºé¢‘ç¹è¯»å†™æ–‡ä»¶åï¼Œä½ ä¼šå‘ç°å¯ç”¨ç‰©ç†å†…å­˜å˜å°‘ã€‚å½“ç³»ç»Ÿçš„ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå°±éœ€è¦å°†ç‰©ç†å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´é‡Šæ”¾å‡ºæ¥ï¼Œä»¥ä¾›å½“å‰è¿è¡Œçš„ç¨‹åºä½¿ç”¨ã€‚é‚£äº›è¢«é‡Šæ”¾çš„ç©ºé—´å¯èƒ½æ¥è‡ªä¸€äº›å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä»€ä¹ˆæ“ä½œçš„ç¨‹åºï¼Œè¿™äº›è¢«é‡Šæ”¾çš„ç©ºé—´è¢«ä¸´æ—¶ä¿å­˜åˆ°Swapç©ºé—´ä¸­ï¼Œç­‰åˆ°é‚£äº›ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œå†ä»Swapåˆ†åŒºä¸­æ¢å¤ä¿å­˜çš„æ•°æ®åˆ°å†…å­˜ä¸­ã€‚è¿™æ ·ï¼Œç³»ç»Ÿæ€»æ˜¯åœ¨ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ï¼Œæ‰è¿›è¡ŒSwapäº¤æ¢ã€‚

ä»Linux kernel version 2.4å¼€å§‹ï¼Œbuffer/cacheåˆå¹¶ï¼ˆè¯¦æƒ…è§ ğŸ‘‰ [Linux IOçš„buffer cacheå’Œpage cacheåˆå¹¶çš„åŸå› ](https://blog.csdn.net/jasonchen_gbd/article/details/80151328)ï¼‰ï¼Œæ‰€ä»¥åŒæ ·ä½¿ç”¨ `free -m` çœ‹åˆ°çš„æ˜¯ï¼š

```sh
[root@k8s-node3 ~]# free -m
              total        used        free      shared  buff/cache   available
Mem:           7820        6577         147          30        1095         907
Swap:             0           0           0
```

> ä½¿ç”¨ `hostnamectl` æˆ–è€… `cat /proc/version` å¯ä»¥æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ï¼š

> ```sh
> [root@k8s-node3 ~]# hostnamectl
> Static hostname: k8s-node3
> Pretty hostname: VM-0-4-centos
>       Icon name: computer-vm
>         Chassis: vm
>      Machine ID: 8a248d59684442b3a2edd315013b7d1f
>         Boot ID: c14dd5b3b84646a58a98db62d5379832
>  Virtualization: kvm
> Operating System: CentOS Linux 7 (Core)
>     CPE OS Name: cpe:/o:centos:centos:7
>          Kernel: Linux 3.10.0-1127.19.1.el7.x86_64
>    Architecture: x86-64
> [root@k8s-node3 ~]# cat /proc/version
> Linux version 3.10.0-1127.19.1.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-39) (GCC) ) #1 SMP Tue Aug 25 17:23:54 UTC 2020
> ```

æˆ‘ä»¬å‡è®¾buffer/cacheè¿˜æ²¡å‘ç”Ÿåˆå¹¶ï¼Œé‚£å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

è¿™é‡Œç½—åˆ—å‡ ä¸ªé«˜èµğŸ‘çŸ¥ä¹å›ç­”ï¼š

[Cache å’Œ Buffer éƒ½æ˜¯ç¼“å­˜ï¼Œä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ](https://www.zhihu.com/question/26190832)

> - cache æ˜¯ä¸ºäº†å¼¥è¡¥é«˜é€Ÿè®¾å¤‡å’Œä½é€Ÿè®¾å¤‡çš„é¸¿æ²Ÿè€Œå¼•å…¥çš„ä¸­é—´å±‚ï¼Œæœ€ç»ˆèµ·åˆ°**åŠ å¿«è®¿é—®é€Ÿåº¦**çš„ä½œç”¨ã€‚
> - è€Œ buffer çš„ä¸»è¦ç›®çš„è¿›è¡Œæµé‡æ•´å½¢ï¼ŒæŠŠçªå‘çš„å¤§æ•°é‡è¾ƒå°è§„æ¨¡çš„ I/O æ•´ç†æˆå¹³ç¨³çš„å°æ•°é‡è¾ƒå¤§è§„æ¨¡çš„ I/Oï¼Œä»¥**å‡å°‘å“åº”æ¬¡æ•°**ï¼ˆæ¯”å¦‚ä»ç½‘ä¸Šä¸‹ç”µå½±ï¼Œä½ ä¸èƒ½ä¸‹ä¸€ç‚¹ç‚¹æ•°æ®å°±å†™ä¸€ä¸‹ç¡¬ç›˜ï¼Œè€Œæ˜¯ç§¯æ”’ä¸€å®šé‡çš„æ•°æ®ä»¥åä¸€æ•´å—ä¸€èµ·å†™ï¼Œä¸ç„¶ç¡¬ç›˜éƒ½è¦è¢«ä½ ç©åäº†ï¼‰ã€‚

[Linuxç³»ç»Ÿä¸­çš„Page cacheå’ŒBuffer cache](https://zhuanlan.zhihu.com/p/35277219)

> ç£ç›˜çš„æ“ä½œæœ‰é€»è¾‘çº§ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰å’Œç‰©ç†çº§ï¼ˆç£ç›˜å—ï¼‰ï¼Œè¿™ä¸¤ç§Cacheå°±æ˜¯åˆ†åˆ«ç¼“å­˜é€»è¾‘å’Œç‰©ç†çº§æ•°æ®çš„ã€‚
>
> å‡è®¾æˆ‘ä»¬é€šè¿‡æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–‡ä»¶å°†è¢«ç¼“å­˜åˆ°Page Cacheï¼Œå¦‚æœéœ€è¦åˆ·æ–°æ–‡ä»¶çš„æ—¶å€™ï¼ŒPage Cacheå°†äº¤ç»™Buffer Cacheå»å®Œæˆï¼Œå› ä¸ºBuffer Cacheå°±æ˜¯ç¼“å­˜ç£ç›˜å—çš„ã€‚
>
> ä¹Ÿå°±æ˜¯è¯´ï¼Œç›´æ¥å»æ“ä½œæ–‡ä»¶ï¼Œé‚£å°±æ˜¯Page CacheåŒºç¼“å­˜ï¼Œç”¨ddç­‰å‘½ä»¤ç›´æ¥æ“ä½œç£ç›˜å—ï¼Œå°±æ˜¯Buffer Cacheç¼“å­˜çš„ä¸œè¥¿ã€‚
>
> Page cacheå®é™…ä¸Šæ˜¯é’ˆå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæ˜¯æ–‡ä»¶çš„ç¼“å­˜ï¼Œåœ¨æ–‡ä»¶å±‚é¢ä¸Šçš„æ•°æ®ä¼šç¼“å­˜åˆ°page cacheã€‚æ–‡ä»¶çš„é€»è¾‘å±‚éœ€è¦æ˜ å°„åˆ°å®é™…çš„ç‰©ç†ç£ç›˜ï¼Œè¿™ç§æ˜ å°„å…³ç³»ç”±æ–‡ä»¶ç³»ç»Ÿæ¥å®Œæˆã€‚å½“page cacheçš„æ•°æ®éœ€è¦åˆ·æ–°æ—¶ï¼Œpage cacheä¸­çš„æ•°æ®äº¤ç»™buffer cacheï¼Œä½†æ˜¯è¿™ç§å¤„ç†åœ¨2.6ç‰ˆæœ¬çš„å†…æ ¸ä¹‹åå°±å˜çš„å¾ˆç®€å•äº†ï¼Œæ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„cacheæ“ä½œã€‚
>
> Buffer cacheæ˜¯é’ˆå¯¹ç£ç›˜å—çš„ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯åœ¨æ²¡æœ‰æ–‡ä»¶ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œç›´æ¥å¯¹ç£ç›˜è¿›è¡Œæ“ä½œçš„æ•°æ®ä¼šç¼“å­˜åˆ°buffer cacheä¸­ï¼Œä¾‹å¦‚ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®éƒ½ä¼šç¼“å­˜åˆ°buffer cacheä¸­ã€‚
>
> ç®€å•è¯´æ¥ï¼Œpage cacheç”¨æ¥ç¼“å­˜æ–‡ä»¶æ•°æ®ï¼Œbuffer cacheç”¨æ¥ç¼“å­˜ç£ç›˜æ•°æ®ã€‚åœ¨æœ‰æ–‡ä»¶ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œå¯¹æ–‡ä»¶æ“ä½œï¼Œé‚£ä¹ˆæ•°æ®ä¼šç¼“å­˜åˆ°page cacheï¼Œå¦‚æœç›´æ¥é‡‡ç”¨ddç­‰å·¥å…·å¯¹ç£ç›˜è¿›è¡Œè¯»å†™ï¼Œé‚£ä¹ˆæ•°æ®ä¼šç¼“å­˜åˆ°buffer cacheã€‚
>
> **Buffer(Buffer Cache)ä»¥å—å½¢å¼ç¼“å†²äº†å—è®¾å¤‡çš„æ“ä½œï¼Œå®šæ—¶æˆ–æ‰‹åŠ¨çš„åŒæ­¥åˆ°ç¡¬ç›˜ï¼Œå®ƒæ˜¯ä¸ºäº†ç¼“å†²å†™æ“ä½œç„¶åä¸€æ¬¡æ€§å°†å¾ˆå¤šæ”¹åŠ¨å†™å…¥ç¡¬ç›˜ï¼Œé¿å…é¢‘ç¹å†™ç¡¬ç›˜ï¼Œæé«˜å†™å…¥æ•ˆç‡ã€‚**
>
> **Cache(Page Cache)ä»¥é¡µé¢å½¢å¼ç¼“å­˜äº†æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œç»™éœ€è¦ä½¿ç”¨çš„ç¨‹åºè¯»å–ï¼Œå®ƒæ˜¯ä¸ºäº†ç»™è¯»æ“ä½œæä¾›ç¼“å†²ï¼Œé¿å…é¢‘ç¹è¯»ç¡¬ç›˜ï¼Œæé«˜è¯»å–æ•ˆç‡ã€‚**



## å‚è€ƒ

[Linux æ“ä½œç³»ç»ŸåŸç† â€” å†…å­˜ â€” Cache å’Œ Buffer](https://blog.csdn.net/Jmilk/article/details/105896326)

[Linuxç³»ç»Ÿä¸­çš„Page cacheå’ŒBuffer cache](https://zhuanlan.zhihu.com/p/35277219)

[Cache å’Œ Buffer éƒ½æ˜¯ç¼“å­˜ï¼Œä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ](https://www.zhihu.com/question/26190832)

[Swapäº¤æ¢åˆ†åŒºæ¦‚å¿µ](
